(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[2421],{4414:function(e,p,o){"use strict";o.d(p,{Z:function(){return j}});var t=o(4454),n=o(3211),i=o(6008),y=o(3251),s=o(1558),a=o(6353),r=o(8170),f=o(1757),l=o(7257),u=o(8093),d=o(8199),c=o(3825),O=o(1159),T=o(6559),g=o(583),h=o(1304),U=o(8763),b=o(5022),R=o(5631),m=o(1317);const w=[-2,-3,-4];var z=o(5078),v=o(3644),E=o(7746),M=o(4370);const x=[-2,-3,-4];var k=o(6187);const Z={lose:"defeat",tie:"victory",win:"victory"};var P=o(5863),H=o(898),j=(0,t.l)(((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.yv)),(0,y.b)((p=>{const{lang:o}=p;return(0,l.H)((e=>{void 0===e.lang?e.lang={code:o,erathian:u.QZ}:e.lang.code=o})),(0,a.z)((0,r.of)({type:n.bd,lang:o})).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n._g)),(0,y.b)((p=>{const{erathian:o}=p;return(0,l.H)((e=>{void 0===e.lang?e.lang={code:d.F,erathian:o}:e.lang.erathian=o})),(0,a.z)((0,r.of)({type:n._G,erathian:o})).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.j4)),(0,y.b)((p=>{const{volume:o}=p;return(0,l.H)((e=>{e.volume=o})),(0,a.z)((0,r.of)({type:n.cJ,volume:o})).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.I4)),(0,y.b)((p=>{const{payload:o}=p;return(0,l.H)((e=>{e.settings=o})),(0,a.z)((0,r.of)({type:n.Nc,payload:o})).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.g$)),(0,c.M)(p),(0,y.b)((([p,o])=>{const t=p.payload.map((e=>{const{isPlayer:p,statusProp:t,noSound:n}=e;let i=null;if("to"in e){const n=o.status[p?"player":"opponent"][t];e.to!==n&&(i=e.to>n)}else 0!==e.diff&&(i=e.diff>0);return n||(0,O.Z)(t,o.volume,i),Object.assign({isPlayer:p,statusProp:t},"to"in e?{to:e.to}:{diff:e.diff})}));return(0,a.z)((0,r.of)({type:n.l7,payload:t}),(0,r.of)({type:n.Qo}),(0,r.of)({type:n.Dt})).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.Uk)),(0,c.M)(p),(0,y.b)((([p,o])=>{const t=o.status.player,i=o.status.opponent,y=Object.assign({},t),a=Object.assign({},i),f=g.Z[p.n],l="player"===p.owner?y:a,u=h.ag[f.type];l[u]-=f.cost;const d=l[u],c=f.effect;"player"===p.owner?c(y,a):c(a,y);const O=(0,T.qh)(y).filter((([e,p])=>p!==t[e])).map((([e,o])=>({isPlayer:!0,statusProp:e,to:o,noSound:"player"===p.owner&&e===u&&o===d}))).concat((0,T.qh)(a).filter((([e,p])=>p!==i[e])).map((([e,o])=>({isPlayer:!1,statusProp:e,to:o,noSound:"opponent"===p.owner&&e===u&&o===d}))));return(0,r.of)({type:n.g$,payload:O}).pipe((0,s.R)(e.ofType(n.OU)))})))),U.Z,((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.fL)),(0,c.M)(p),(0,y.b)((([{index:p,position:o,owner:t},i])=>((0,O.Z)("deal",i.volume),(0,a.z)(i.game.isNewTurn?(0,r.of)({type:n.kH}):R.E,(0,r.of)({type:n.iE,index:p}),(0,r.of)({type:n.Jn,index:p}).pipe((0,b.g)(0)),(0,r.of)({type:n.fj,index:p,position:o,owner:t}),i.game.discardMode?(0,a.z)((0,r.of)({type:n.vd,on:!1}),(0,r.of)({type:n.NX})).pipe((0,s.R)(e.ofType(n.OU))):(0,a.z)((0,r.of)({type:n.Ut,on:!0}),(0,r.of)({type:n.jV}).pipe((0,b.g)(m.RE))).pipe((0,s.R)(e.ofType(n.OU)))).pipe((0,s.R)(e.ofType(n.OU)))))))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.Jn)),(0,c.M)(p),(0,y.b)((([p,o])=>{const t=o.cards.list,i=t[p.index];if(null!==i&&!1===w.includes(i.position)){const o=w.find((e=>t.every((p=>(null==p?void 0:p.position)!==e))));return void 0===o?(0,a.z)((0,r.of)({type:n.kH}),(0,r.of)({type:n.Jn,index:p.index})).pipe((0,s.R)(e.ofType(n.OU))):(0,r.of)({type:n._d,index:p.index,toPosition:o}).pipe((0,s.R)(e.ofType(n.OU)))}return R.E})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.DM)),(0,y.b)((({payload:e})=>(0,a.z)((0,r.of)({type:n.OU}),(0,r.of)({type:n.I4,payload:e}),(0,r.of)({type:n.qg}).pipe((0,b.g)(0))))))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.Qb)),(0,y.b)((p=>{const o=(0,l.U)(["lang","code"]),t=(0,l.U)(["lang","erathian"]),i=(0,l.U)(["settings"]),y=(0,l.U)(["volume"]);return(0,a.z)(null!==i?(0,r.of)({type:n.Nc,payload:i}):R.E,null!==o?(0,r.of)({type:n.bd,lang:o}):R.E,null!==t?(0,r.of)({type:n._G,erathian:t}):R.E,null!==y?(0,r.of)({type:n.cJ,volume:y}):R.E,(0,r.of)({type:n.qg})).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.qg)),(0,c.M)(p),(0,y.b)((([p,o])=>{const t=Math.random()<.5,i=o.settings.cardsInHand,y={total:{player:i,opponent:i},list:[],nextPos:{player:i,opponent:i}};for(let e=0,p=2*i;e<p;e++){const p={position:e%i,n:(0,z.d)(),unusable:!1,discarded:!1,isFlipped:!1,zeroOpacity:!1,owner:e<i?"player":"opponent"};y.list.push(p)}return(0,a.z)((0,r.of)({type:n.zn,payload:y}),(0,r.of)({type:n.s3,playersTurn:t}),(0,r.of)({type:n.F5,payload:o.settings.start}),(0,r.of)({type:n.k4,owner:t?"player":"opponent"}),(0,r.of)({type:n.NX}).pipe((0,b.g)(0))).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.NX)),(0,c.M)(p),(0,y.b)((([p,o])=>{const t=(0,z.d)(),i=o.game.playersTurn?"player":"opponent";return(0,O.Z)("deal",o.volume),(0,a.z)((0,r.of)({type:n.Ut,on:!0,locknumber:1}),(0,r.of)({type:n.$Z,n:t}),(0,r.of)({type:n.Qo,lastOnly:!0}),(0,r.of)({type:n.B4,owner:i}).pipe((0,b.g)(m.Fi)),(0,r.of)({type:n.Ut,on:!1,locknumber:1}).pipe((0,b.g)(0)),"opponent"===i&&v.Hz?(0,r.of)({type:n.zL}).pipe((0,b.g)(m.RE+m.CF+(v.G1?0:v.kQ)),(0,s.R)(e.ofType(n.OU))):R.E,"player"===i?(0,r.of)({type:n.yh}).pipe((0,b.g)(0),(0,s.R)(e.ofType(n.OU))):R.E).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.jV)),(0,c.M)(p),(0,y.b)((([p,o])=>(0,a.z)((0,r.of)({type:n.K5}),(0,r.of)({type:n.k4,owner:o.game.playersTurn?"opponent":"player"}),(0,r.of)({type:n.Ut,on:!1}),(0,r.of)({type:n.NX}).pipe((0,b.g)(0)),(0,r.of)({type:n.Z$,on:!0})).pipe((0,s.R)(e.ofType(n.OU))))))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.k4)),(0,c.M)(p),(0,y.b)((([p,o])=>{const t=o.status[p.owner],i=(0,T.qh)(h.cs).map((([e,o])=>({isPlayer:"player"===p.owner,statusProp:o,diff:t[e],noSound:!0})));return(0,r.of)({type:n.g$,payload:i}).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.kH)),(0,c.M)(p),(0,E.zg)((([p,o])=>{const t=[],i=[],y=[];return x.forEach((e=>{o.cards.list.forEach(((p,o)=>{null!==p&&p.position===e&&(t.push((0,r.of)({type:n.EK,index:o})),i.push((0,r.of)({type:n.OK,index:o}).pipe((0,b.g)(m.RE))),y.push((0,r.of)({type:n.M2,index:o}).pipe((0,b.g)(2*m.RE))))}))})),(0,M.T)((0,r.of)({type:n.Z$,on:!1}),(0,M.T)(...t,...i,...y)).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.Qo)),(0,c.M)(p),(0,y.b)((([p,o])=>{const t=[],i=[],y=(e,n)=>{if(null!==e){const y=p.lastOnly?o.game.playersTurn?"player":"opponent":e.owner;if("common"!==y){const{type:p,cost:s}=g.Z[e.n];o.status[y][h.ag[p]]<s?e.unusable||t.push(n):e.unusable&&i.push(n)}}};if(p.lastOnly){const e=o.cards.list,p=e.length-1;y(e[p],p)}else o.cards.list.forEach(y);return(0,r.of)({type:n.R9,unusables:t,usables:i}).pipe((0,s.R)(e.ofType(n.OU)))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.Dt)),(0,c.M)(p),(0,y.b)((([p,o])=>{const{tower:t,resource:i}=o.settings.win,{player:y,opponent:a}=o.status,f=y.tower>=t||a.tower<=0||h.ag.some((e=>y[e]>=i)),l=a.tower>=t||y.tower<=0||h.ag.some((e=>a[e]>=i));return f&&!l?(0,r.of)({type:n.Wz,payload:{type:"win"}}).pipe((0,s.R)(e.ofType(n.OU))):!f&&l?(0,r.of)({type:n.Wz,payload:{type:"lose"}}).pipe((0,s.R)(e.ofType(n.OU))):f&&l?(0,r.of)({type:n.Wz,payload:{type:"tie"}}).pipe((0,s.R)(e.ofType(n.OU))):R.E})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.Wz)),(0,c.M)(p),(0,y.b)((([e,p])=>{const{payload:o}=e;return(0,k.U)(o)&&(0,O.Z)(Z[o.type],p.volume),(0,a.z)((0,r.of)({type:n.OU}),(0,r.of)({type:n.SO,payload:o}))})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.zL)),(0,c.M)(p),(0,y.b)((([p,o])=>{const t=(0,P.ai)(o);if(null===t)return(0,r.of)({type:n.Wz,payload:{type:"win",surrender:!0}}).pipe((0,s.R)(e.ofType(n.OU)));const{index:i,use:y}=t,a=o.cards.list[i];if(null!==a&&"common"!==a.owner){const{n:p,position:o,owner:t}=a;return y?(0,r.of)({type:n.u3,index:i,n:p,position:o,owner:t}).pipe((0,s.R)(e.ofType(n.OU))):(0,r.of)({type:n.fL,index:i,position:o,owner:t}).pipe((0,s.R)(e.ofType(n.OU)))}return R.E})))),((e,p)=>e.pipe((0,i.h)((0,f.isOfType)(n.yh)),(0,c.M)(p),(0,y.b)((([p,o])=>0===(0,H.Z)(o,"player").filter((e=>e.canuse||e.candiscard)).length?(0,r.of)({type:n.Wz,payload:{type:"lose",surrender:!0}}).pipe((0,s.R)(e.ofType(n.OU))):R.E)))))}}]);