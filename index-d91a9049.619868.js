(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[2078],{898:function(e,t,r){"use strict";var a=r(3644),n=r(583);t.Z=(e,t)=>{const{discardMode:r}=e.game,o=e.cards.list,i=[];return o.forEach(((e,o)=>{var c,s;if(null!==e&&e.owner===t){let t=!1,l=!1;const{n:d}=e;r?!a.rd&&(null===(c=n.Z[d].special)||void 0===c?void 0:c.undiscardable)||(l=!0):e.unusable||(t=!0),(!(null===(s=n.Z[d].special)||void 0===s?void 0:s.undiscardable)||r&&a.rd)&&(l=!0),i.push({index:o,n:d,score:0,canuse:t,candiscard:l})}})),i}},5863:function(e,t,r){"use strict";r.d(t,{ai:function(){return s}});var a=r(898),n=r(1304),o=r(583),i=r(6559),c={bricks:1,gems:1.28,recruits:1.05,brickProd:18,gemProd:23.04,recruitProd:18.9,tower:3.67,wall:2.02,playagain:46,drawDiscardPlayagain:27.6,undiscardable:2.03,useDiscardRatio:2.18,loseDeduction:999,enemy:1.08,randomDice:100};const s=e=>((e,t,r)=>{const{player:a,opponent:s}=t;for(const t of e){t.score=0;const{index:e,n:l,canuse:d}=t,m=o.Z[l],{type:u,cost:p,special:g,effect:b}=m,{tower:h,resource:f}=r,w=Object.assign({},a),y=Object.assign({},s);b(y,w);const $=y.tower>=h||y.bricks>=f||y.gems>=f||y.recruits>=f||w.tower<=0,v=w.tower>=h||w.bricks>=f||w.gems>=f||w.recruits>=f||y.tower<=0;if(d&&$&&!v)return{index:e,use:!0};if(d&&$&&v)return{index:e,use:!0};const x=(0,i.sq)((0,i.qh)(s).map((([e,t])=>[e,y[e]-t]))),E=(0,i.sq)((0,i.qh)(a).map((([e,t])=>[e,w[e]-t])));x[n.ag[u]]-=p;const k=n.PO.map((e=>x[e]*c[e])).reduce(((e,t)=>e+t),0),C=n.PO.map((e=>E[e]*c[e]*c.enemy)).reduce(((e,t)=>e+t),0);t.score+=k-C,(null==g?void 0:g.playagain)&&(t.score+=c.playagain),(null==g?void 0:g.drawDiscardPlayagain)&&(t.score+=c.drawDiscardPlayagain),(null==g?void 0:g.undiscardable)&&(t.score+=c.undiscardable),v&&(t.score-=c.loseDeduction)}const l=e.map(((e,t)=>({card:e,use:!0,scoreAll:e.score}))),d=e.map(((e,t)=>({card:e,use:!1,scoreAll:e.score/c.useDiscardRatio*-1}))),m=l.concat(d).filter((e=>e.use&&e.card.canuse||!e.use&&e.card.candiscard));if(0===m.length)return null;const u=m.reduce(((e,t)=>e.scoreAll>t.scoreAll?e:t));return{index:u.card.index,use:u.use}})((0,a.Z)(e,"opponent"),e.status,e.settings.win)},8523:function(e,t,r){"use strict";r.d(t,{Z:function(){return pe}});var a=r(7294),n=r(4184),o=r.n(n),i=r(7889),c=r(6360),s=r(8255),l=r(8023),d=r(6399),m=r(124),u=r(5678),p=r(8377),g=r(4983);const b=(e,t)=>{const r=e*t;return r>=12?r:12},h=(e,t)=>1.2*b(e,t),f=e=>`(${e}px - 1.25rem * 2 - (1.75rem + 0.25rem * 2 + 1rem) - (0.25rem * 2 + ${h(e,.036)}px + 0.25rem + 0.75rem) * 3) / 3`,w=e=>`${f(e)} / 0.7222222222222222 + 0.25rem * 2 + 1.25rem * 2`,y=(0,i.QM)({brick:{background:{image:`url(${m.Z})`}},gem:{background:{image:`url(${u.Z})`}},recruit:{background:{image:`url(${p.Z})`}},prod:{"font-size":e=>`${b(e,.05)}px`,"line-height":e=>`${h(e,.05)}px`,"margin-bottom":"-0.2em"},count:{"font-size":e=>`${b(e,.036)}px`,"line-height":e=>`${h(e,.036)}px`,height:e=>`${h(e,.036)}px`},unit:{"font-size":e=>`${b(e,.036)}px`,"line-height":e=>`${h(e,.036)}px`,height:e=>`${h(e,.036)}px`}});var $=(0,a.memo)((({type:e,count:t,prod:r})=>{const n=(0,a.useContext)(g.OO),i=(0,a.useContext)(s.$K).height/3*2,c=y(i),m={brick:"red",gem:"blue",recruit:"green"}[e],u={brick:n.i18n("bricks"),gem:n.i18n("gems"),recruit:n.i18n("recruits")}[e];return a.createElement("div",{className:o()("mb-3 p-1 shadow-lg",`bg-${m}-300`)},a.createElement("div",{className:o()(c[e],"bg-no-repeat bg-cover bg-center border border-l-darkborder border-t-darkborder border-r-lightborder border-b-lightborder relative"),style:{height:`calc(${f(i)})`}},a.createElement("div",{className:o()("text-yellow-400 absolute bottom-1 left-1 text-shadow-md tracking-tighter","fatnumber",c.prod)},a.createElement(d.Z,{n:r}),a.createElement(l.Z,{n:r}))),a.createElement("div",{className:"flow-root mt-1"},a.createElement("div",{className:o()("float-left text-black flex-1 text-left relative tracking-tighter","fatnumber",c.count)},a.createElement(d.Z,{n:t}),a.createElement(l.Z,{n:t})),a.createElement("div",{className:o()("float-right text-black flex-1 text-right","robotocondensed",c.unit)},u)))}));const v=(0,i.QM)({username:{"transition-property":"color, border-color","transition-timing-function":"ease-in-out","transition-duration":"0.3s"}});var x=(0,a.memo)((({playerName:e,bricks:t,gems:r,recruits:n,brickProd:i,gemProd:l,recruitProd:d,isOpponent:m=!1})=>{const u=(0,c.C)((e=>e.game.playersTurn)),p=(0,a.useContext)(s.$K).height/3*2,g=v();return a.createElement("div",{className:"z-20 p-5 h-full relative",style:{width:`calc(${w(p)})`,float:m?"right":"left"}},a.createElement("div",{className:"bg-black bg-opacity-50 mb-4 p-1 shadow-lg"},a.createElement("div",{className:o()("border border-yellow-400 text-yellow-400 text-center h-7 leading-7 font-mono",{"border-opacity-25 text-opacity-25":u===m},g.username)},e)),a.createElement($,{type:"brick",count:t,prod:i}),a.createElement($,{type:"gem",count:r,prod:l}),a.createElement($,{type:"recruit",count:n,prod:d}))})),E=r(9624),k=r(688),C=r(8415),N=r(3014);const Z=e=>`(${e}px - (1.75rem + 0.25rem * 2)) / (282 + 600)`,P=e=>`${Z(e)} * 204`,z=e=>`${Z(e)} * ((204 - 135) / 2)`,O=(e,t)=>`calc((${P(e)} - ${z(e)} * 2) / 135 * 600 * ${t})`,M=(0,i.QM)({main:{width:({height:e})=>`calc(${P(e)})`},towerwrapper:{height:({height:e})=>O(e,1),bottom:"calc(1.75rem + 0.25rem * 2)","padding-left":({height:e})=>`calc(${z(e)})`,"padding-right":({height:e})=>`calc(${z(e)})`},towerbody:{background:{image:`url(${k.Z})`,repeat:"repeat-y",size:"100%",position:"center 0"},width:({height:e})=>`calc(100% - ${z(e)} * 2)`,height:({height:e,current:t,goal:r})=>O(e,t/r),"max-height":({height:e})=>O(e,1),"will-change":"height","transition-property":"height","transition-timing-function":"linear","transition-duration":"0.4s","&:before":{content:'""',position:"absolute",top:({height:e})=>`calc(0px - ${P(e)} / 204 * 282 + 1px)`,left:({height:e})=>`calc(0px - ${z(e)})`,right:({height:e})=>`calc(0px - ${z(e)})`,width:({height:e})=>`calc(${P(e)})`,height:({height:e})=>`calc(${P(e)} / 204 * 282)`,display:"block",background:{repeat:"no-repeat",size:"100%",position:"center 0"}}},towerbodyred:{"&:before":{background:{image:`url(${C.Z})`}}},towerbodyblue:{"&:before":{background:{image:`url(${N.Z})`}}}});var D=(0,a.memo)((({isOpponent:e=!1,goal:t,current:r})=>{const n=(0,a.useContext)(s.$K).height/3*2,i=M({height:n,current:r,goal:t});return a.createElement("div",{className:o()("h-full mx-1 relative","float-"+(e?"right":"left"),i.main)},a.createElement("div",{className:o()("z-20 w-full absolute",i.towerwrapper)},a.createElement("div",{className:o()("absolute bottom-0",i.towerbody,i[e?"towerbodyblue":"towerbodyred"])})),a.createElement("div",{className:"bg-black bg-opacity-50 p-1 shadow-lg w-full absolute bottom-0"},a.createElement("div",{className:"border border-yellow-400 border-opacity-25 text-yellow-400 text-center h-7 leading-7 font-mono"},a.createElement(d.Z,{n:r}),a.createElement(l.Z,{n:r}),a.createElement(E.Z,{n:r}))))})),L=r(5844);const K=e=>`(${e}px - (1.75rem + 0.25rem * 2)) / (282 + 600)`,X=(e,t)=>`calc(${K(e)} * 597 * ${t/100})`,j=(0,i.QM)({main:{width:e=>`calc(${K(e)} * 72 + 1rem * 2)`},wallwrapper:{height:e=>X(e,100),bottom:"calc(1.75rem + 0.25rem * 2)"},wallbody:{background:{image:`url(${L.Z})`,repeat:"repeat-y",size:"100%",position:"center 0"},width:e=>`calc(${K(e)} * 72)`,"max-height":e=>`calc(${K(e)} * 597)`,"will-change":"height","transition-property":"height","transition-timing-function":"linear","transition-duration":"0.4s"}});var Q=(0,a.memo)((({current:e,isOpponent:t=!1})=>{const r=(0,a.useContext)(s.$K).height/3*2,n=j(r);return a.createElement("div",{className:o()("h-full mx-2 relative","float-"+(t?"right":"left"),n.main)},a.createElement("div",{className:o()("z-20 w-full absolute px-4",n.wallwrapper)},a.createElement("div",{className:o()("absolute bottom-0",n.wallbody),style:{height:X(r,e)}})),a.createElement("div",{className:"bg-black bg-opacity-50 p-1 shadow-lg w-full absolute bottom-0"},a.createElement("div",{className:"border border-yellow-400 border-opacity-25 text-yellow-400 text-center h-7 leading-7 font-mono"},a.createElement(d.Z,{n:e}),a.createElement(l.Z,{n:e}),a.createElement(E.Z,{n:e}))))})),R=r(7977),H=r(3705);const I=(0,i.QM)({main:{background:{image:`url(${H.Z})`,repeat:"no-repeat",size:"cover",position:"center 30%"}}});var q=(0,a.memo)((()=>{const e=(0,c.C)((e=>e.settings.playerName)),t=(0,c.C)((e=>e.settings.opponentName)),r=(0,c.C)((e=>e.status.player.bricks)),n=(0,c.C)((e=>e.status.player.gems)),i=(0,c.C)((e=>e.status.player.recruits)),s=(0,c.C)((e=>e.status.player.brickProd)),l=(0,c.C)((e=>e.status.player.gemProd)),d=(0,c.C)((e=>e.status.player.recruitProd)),m=(0,c.C)((e=>e.status.player.tower)),u=(0,c.C)((e=>e.status.player.wall)),p=(0,c.C)((e=>e.status.opponent.bricks)),g=(0,c.C)((e=>e.status.opponent.gems)),b=(0,c.C)((e=>e.status.opponent.recruits)),h=(0,c.C)((e=>e.status.opponent.brickProd)),f=(0,c.C)((e=>e.status.opponent.gemProd)),w=(0,c.C)((e=>e.status.opponent.recruitProd)),y=(0,c.C)((e=>e.status.opponent.tower)),$=(0,c.C)((e=>e.status.opponent.wall)),v=I();return a.createElement("div",{className:o()("z-0 h-2/3 flex-auto bg-green-100 relative",v.main)},a.createElement(x,{playerName:e,bricks:r,gems:n,recruits:i,brickProd:s,gemProd:l,recruitProd:d}),a.createElement(D,{goal:100,current:m}),a.createElement(Q,{current:u}),a.createElement(x,{playerName:t,bricks:p,gems:g,recruits:b,brickProd:h,gemProd:f,recruitProd:w,isOpponent:!0}),a.createElement(D,{isOpponent:!0,goal:100,current:y}),a.createElement(Q,{isOpponent:!0,current:$}),a.createElement(R.Z,null))})),A=r(3211),_=r(1317),B=r(604),S=r(583),T=r(5770),Y=r(1528),F=r(2919),U=r(5483),W=r(1626),G=r(3644),J=r(3543);const V=({unusable:e,zeroOpacity:t})=>t?0:e?_.fv:1,ee=(0,i.QM)({main:{width:({cardPos:e})=>null==e?void 0:e.width,height:({cardPos:e})=>null==e?void 0:e.height,top:({cardPos:e,total:t,position:r})=>null==e?void 0:e[t===e.total?"top":"topM1"][r+5],left:({cardPos:e,total:t,position:r})=>null==e?void 0:e[t===e.total?"left":"leftM1"][r+5],"font-size":({cardPos:e})=>e?.094*e.width:16,"will-change":"transform, left, top, box-shadow","transition-property":"opacity, transform, left, top, box-shadow","transition-timing-function":"ease-in-out","transition-duration":`${_.RE}ms`},cardname:{"font-size":({cardPos:e,cardNameLength:t})=>t>_.oK?(e?.094*e.width:16)*(_.oK+1)/t:"auto"},isflipped:{transform:"translateX(-100%) rotateY(-179.99deg)"},cardeffect:{"transform-style":"preserve-3d","transform-origin":"center right"},cardfront:{"background-image":`url(${T.Z})`,"backface-visibility":"hidden",opacity:V,"will-change":"transform, left, top, box-shadow","transition-property":"opacity, transform, left, top, box-shadow","transition-timing-function":"ease-in-out","transition-duration":`${_.RE}ms`,"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${_.st}, ${_.st}, ${_.st}, ${_.LX}), rgba(0, 0, 0, 0), rgba(${_.st}, ${_.st}, ${_.st}, ${_.LX}))`}},unusableopacity:{opacity:_.fv},cardback:{background:{image:`url(${Y.Z})`,size:"cover",position:"center",repeat:"no-repeat"},opacity:V,"will-change":"transform, left, top, box-shadow","transition-property":"opacity, transform, left, top, box-shadow","transition-timing-function":"ease-in-out","transition-duration":`${_.RE}ms`,"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${_.st}, ${_.st}, ${_.st}, ${_.LX}), rgba(0, 0, 0, 0), rgba(${_.st}, ${_.st}, ${_.st}, ${_.LX}))`}},cardbackeffect:{transform:"translateX(0) rotateY(180deg)","backface-visibility":"hidden"},cardbackhard:{background:{image:`url(${Y.Z})`,size:"cover",position:"center",repeat:"no-repeat"},"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${_.st}, ${_.st}, ${_.st}, ${_.LX}), rgba(0, 0, 0, 0), rgba(${_.st}, ${_.st}, ${_.st}, ${_.LX}))`}},image:{height:"calc((100% / 63 * 47 - 0.5rem) / 22 * 13)","font-size":"125%"},text:{height:"calc(100% - (1.25rem + 0.25rem + 0.25rem) - (0.5rem + 0.5rem) - (100% / 63 * 47 - 0.5rem) / 22 * 13)"},resall:{width:({cardPos:e})=>.2*(e?e.width:0),height:({cardPos:e})=>.2*(e?e.width:0),"line-height":({cardPos:e})=>.2*(e?e.width:0)+"px"},resbg:{"background-image":({type:e})=>void 0===e?"none":`url(${[F.Z,U.Z,W.Z][e]})`,background:{repeat:"no-repeat",size:"cover",position:"center center"},opacity:_.Em}});var te=(0,a.memo)((({n:e,unusable:t=!1,discarded:n=!1,position:i,owner:s="common",index:l=-1,isFlipped:d=!1,zeroOpacity:m=!1})=>{const u=(0,a.useContext)(g.OO),p=u.cards(e,"name"),b=p.length,h=(0,c.C)((e=>e.game.playersTurn)),f=(0,c.C)((e=>e.game.locked)),w=(0,c.C)((e=>e.game.discardMode)),y=(0,a.useRef)(null),$=(0,c.C)((e=>e.cards.total)),v=(0,c.T)(),x=(0,a.useContext)(J._),E="common"===s?$[h?"player":"opponent"]:$[s];if(-1===e||G.E5&&"opponent"===s){const r=ee({cardPos:x,total:E,position:i,unusable:t,zeroOpacity:m,cardNameLength:b});return a.createElement("button",{ref:y,disabled:!0,className:o()(r.main,r.cardbackhard,"transform absolute rounded shadow-lg",{"opacity-0 pointer-events-none":h&&"opponent"===s||!h&&"player"===s,[r.unusableopacity]:-1===e})})}{const{type:c,cost:g,special:$}=S.Z[e],k=ee({cardPos:x,total:E,position:i,type:c,unusable:t,zeroOpacity:m,cardNameLength:b}),C=["red","blue","green"][c];let N=!0;const Z=()=>{"common"!==s&&v({type:A.u3,n:e,index:l,position:i,owner:s})},P=()=>{"common"!==s&&v({type:A.fL,index:l,position:i,owner:s})},z=(()=>{if(!("common"===s||f[0]||f[1]||G.Hz&&"opponent"===s))if(w){if(G.rd||!(null==$?void 0:$.undiscardable))return N=!1,{onClick:P}}else if(!t)return N=!1,{onClick:Z};return{}})(),O="common"===s||f[0]||f[1]||!(!(null==$?void 0:$.undiscardable)||w&&G.rd)||G.Hz&&"opponent"===s?{}:(N=!1,{onContextMenu:e=>{e.preventDefault(),P()}});return(h&&"opponent"===s||!h&&"player"===s)&&(N=!0),a.createElement("button",Object.assign({ref:y,className:o()(k.main,k.cardeffect,{[k.isflipped]:d},"transform absolute rounded",{"opacity-0 pointer-events-none":h&&"opponent"===s||!h&&"player"===s},{"shadow-lg":-1!==i},{"cursor-pointer hover:scale-105":i>=0}),accessKey:!N&&i>=0&&i<9?(i+1).toString(10):"",tabIndex:N?-1:i+1,disabled:N},z,O,{onKeyDown:e=>{if("Delete"===e.key||"Backspace"===e.key){const e=y.current;if(e){const t=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!1,view:window,button:2,buttons:0,clientX:e.getBoundingClientRect().x,clientY:e.getBoundingClientRect().y});e.dispatchEvent(t)}}}}),a.createElement("div",{className:o()(k.cardfront,"absolute top-0 bottom-0 left-0 right-0 rounded",`bg-${C}-300`)},a.createElement("div",{className:o()(k.cardname,"m-1 shadow text-center font-bold leading-5 h-5",`bg-${C}-200`)},p),a.createElement("div",{className:o()(k.image,"m-1 shadow bg-no-repeat bg-cover bg-center flex justify-center items-center text-red-600 font-bold uppercase text-shadow-stroke"),style:{backgroundImage:`url(${r(5303)(`./${S.Z[e].type.toString()}_${(e%B.o).toString()}.png`).default})`}},n&&u.i18n("discarded")),a.createElement("div",{className:o()(k.text,"m-2 flex flex-wrap content-center justify-center")},a.createElement("div",{className:"leading-tight break-words text-center"},u.cards(e,"desc"))),a.createElement("div",{className:o()(k.resall,"absolute bottom-1 right-1 text-center font-bold")},a.createElement("div",{className:o()(k.resbg,"absolute top-0 left-0 w-full h-full")}),a.createElement("div",{className:"absolute top-0 left-0 w-full h-full"},g))),a.createElement("div",{className:o()(k.cardback,k.cardbackeffect,"absolute top-0 bottom-0 left-0 right-0 rounded")}))}})),re=r(515);const ae=(0,i.QM)({main:{background:{image:"linear-gradient(#326a4b, #000 2rem)"}}});var ne=(0,a.memo)((()=>{const e=(0,c.C)((e=>e.cards.list)),t=(0,c.C)((e=>e.settings.cardsInHand)),r=(0,c.C)((e=>e.game.discardMode)),n=(0,a.useContext)(s.$K),i=n.height,l=n.width,d=ae();return a.createElement(J.f,{cardsInHand:t,winHeight:i,winWidth:l},a.createElement("div",{className:o()(d.main,"h-1/3 flex-auto")},a.createElement(te,{n:-1,position:-1,unusable:!0}),e.map(((e,t)=>null===e?null:a.createElement(te,Object.assign({key:t,index:t},e)))),a.createElement(re.Z,{shown:r})))})),oe=r(6347),ie=r(6194),ce=r(6657),se=r(6499),le=r(1786),de=r(5586),me=r(6187);const ue=(0,i.QM)({main:{"min-width":`${s.ih}px`,"min-height":`${s.jw}px`}});var pe=(0,a.memo)((()=>{const e=ue(),t=(0,c.C)((e=>e.screen.pref)),r=(0,c.C)((e=>e.screen.langPref)),n=(0,c.C)((e=>e.screen.volumePref)),i=(0,c.C)((e=>e.screen.end)),s=(0,c.C)((e=>e.screen.help)),l=(0,c.C)((e=>e.lang.erathian));return a.createElement("div",{className:o()("w-screen h-screen flex flex-col bg-black overflow-x-hidden select-none",{erathian:l},e.main),tabIndex:-1},a.createElement(q,null),a.createElement(ne,null),(0,me.U)(i)&&a.createElement(ie.Z,Object.assign({},i)),t&&a.createElement(ce.Z,null),r&&a.createElement(se.Z,null),n&&a.createElement(le.Z,null),s&&a.createElement(de.Z,null),a.createElement(oe.Z,null))}))}}]);