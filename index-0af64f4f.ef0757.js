(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[8761],{5782:function(e,p,o){"use strict";o.d(p,{Z:function(){return Y}});var t=o(4454),n=o(7515),i=o(7102),y=o(706),s=o(3201),r=o(4132),a=o(3211),f=o(6008),l=o(3825),d=o(3251),u=o(1558),c=o(1757),T=o(6559),O=o(583),g=o(1304),h=o(8170),w=o(6353),m=o(5631),b=o(3875),R=o(6324),x=o(6306),Z=o(5760),U=o(5022),z=o(1159),E=o(1317),k=o(7750);const M=[-2,-3,-4];var v=o(6320),_=o(7032),H=o(5078),q=o(7456),P=o(3644),S=o(6709),N=o(7746),j=o(4370);const I=[-2,-3,-4];var X=o(8373),$=o(5863),J=o(898),L=o(4694),W=o(7878),C=o(7365),D=o(8410),K=o(7360),F=o(228),Q=o(441),V=o(2087),A=o(7936),B=o(751),G=o(9970),Y=(0,t.l)(n.Z,i.Z,y.Z,s.Z,r.Z,((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.Uk)),(0,l.M)(p),(0,d.b)((([p,o])=>{const t=o.status.player,n=o.status.opponent,i=Object.assign({},t),y=Object.assign({},n),s=O.Z[p.n],r="player"===p.owner?i:y,f=g.ag[s.type];r[f]-=s.cost;const l=r[f],d=s.effect;"player"===p.owner?d(i,y):d(y,i);const c=(0,T.qh)(i).filter((([e,p])=>p!==t[e])).map((([e,o])=>({isPlayer:!0,statusProp:e,to:o,noSound:"player"===p.owner&&e===f&&o===l}))).concat((0,T.qh)(y).filter((([e,p])=>p!==n[e])).map((([e,o])=>({isPlayer:!1,statusProp:e,to:o,noSound:"opponent"===p.owner&&e===f&&o===l}))));return(0,h.of)({type:a.g$,payload:c}).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.qr)),(0,l.M)(p),(0,d.b)((([p,o])=>{const{n:t,index:n,position:i,owner:y}=p,s=o.multiplayer.gameStarted;return(0,w.z)((0,h.of)({type:a.ao,n:t,index:n,position:i,owner:y}),s?(0,h.of)({type:a.H8,kind:b.d,data:{type:a.u3,payload:{type:a.ao,n:t,index:n,position:i,owner:(0,R._w)(y)}}}):m.E).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.u3)),(0,d.b)((e=>{const{payload:p}=e;return x.f.enqueue(p),m.E})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.tI)),(0,d.b)((p=>{const o=x.f.dequeueAsync();return(0,Z.D)(o).pipe((0,d.b)((e=>(0,h.of)(e))),(0,u.R)(e.ofType(a.Cv)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.ao)),(0,l.M)(p),(0,d.b)((([p,o])=>{const{n:t,index:n,position:i,owner:y}=p,s=O.Z[t].special;return(0,z.Z)("deal",o.volume),(0,w.z)(o.game.isNewTurn?(0,h.of)({type:a.kH}):m.E,(0,h.of)({type:a.Uk,n:t,owner:y}),(0,h.of)({type:a.PX,index:n}),(0,h.of)({type:a.fj,index:n,position:i,owner:y}),(0,h.of)({type:a.Ut,on:!0}),(null==s?void 0:s.drawDiscardPlayagain)?(0,w.z)((0,h.of)({type:a.vd,on:!0}),(0,h.of)({type:a.NX}).pipe((0,U.g)(0)),(0,h.of)({type:a.Jn,index:n}).pipe((0,U.g)(E.RE+E.Oz)),(0,h.of)({type:a.Ut,on:!1})):(0,w.z)((0,h.of)({type:a.Jn,index:n}).pipe((0,U.g)(E.RE+E.Oz)),(null==s?void 0:s.playagain)?(0,w.z)((0,h.of)({type:a.NX}).pipe((0,U.g)(0)),(0,h.of)({type:a.Ut,on:!1})):(0,h.of)({type:a.jV}).pipe((0,U.g)(E.RE)))).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.fL)),(0,l.M)(p),(0,d.b)((([p,o])=>{const{index:t,position:n,owner:i}=p,y=o.multiplayer.gameStarted;return(0,w.z)((0,h.of)({type:a.xr,index:t,position:n,owner:i}),y?(0,h.of)({type:a.H8,kind:b.d,data:{type:a.u3,payload:{type:a.xr,index:t,position:n,owner:(0,R._w)(i)}}}):m.E).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.xr)),(0,l.M)(p),(0,d.b)((([p,o])=>{const{index:t,position:n,owner:i}=p;return(0,z.Z)("deal",o.volume),(0,w.z)(o.game.isNewTurn?(0,h.of)({type:a.kH}):m.E,(0,h.of)({type:a.iE,index:t}),(0,h.of)({type:a.Jn,index:t}).pipe((0,U.g)(0)),(0,h.of)({type:a.fj,index:t,position:n,owner:i}),o.game.discardMode?(0,w.z)((0,h.of)({type:a.vd,on:!1}),(0,h.of)({type:a.NX})):(0,w.z)((0,h.of)({type:a.Ut,on:!0}),(0,h.of)({type:a.jV}).pipe((0,U.g)(E.RE)))).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.Jn)),(0,l.M)(p),(0,d.b)((([p,o])=>{const t=o.cards.list,n=t[p.index];if(null!==n&&!1===M.includes(n.position)){const o=M.find((e=>t.every((p=>(null==p?void 0:p.position)!==e))));return void 0===o?(0,w.z)((0,h.of)({type:a.kH}),(0,h.of)({type:a.Jn,index:p.index})).pipe((0,u.R)(e.ofType(a.OU))):(0,h.of)({type:a._d,index:p.index,toPosition:o}).pipe((0,u.R)(e.ofType(a.OU)))}return m.E})))),v.Z,_.Z,((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.qg)),(0,l.M)(p),(0,d.b)((([p,o])=>{const t=o.multiplayer.on&&"connected_to_id"===o.multiplayer.status,n=Math.random()<.5,i=[],y=o.settings.cardsInHand;for(let e=0,p=2*y;e<p;e++){const p={position:e%y,n:(0,H.d)(),unusable:!1,discarded:!1,isFlipped:!1,zeroOpacity:!1,owner:e<y?"player":"opponent"};i.push(p)}return(0,w.z)((0,h.of)({type:a.pS,playersTurn:n,cardList:i}),t?(0,h.of)({type:a.H8,kind:b.d,data:{type:a.pS,playersTurn:!n,cardList:(0,R.b1)(i)}}):m.E).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.pS)),(0,l.M)(p),(0,d.b)((([p,o])=>{const t=o.multiplayer.on&&"connected_to_id"===o.multiplayer.status,n=o.multiplayer.on&&"connected_by_id"===o.multiplayer.status,{playersTurn:i,cardList:y}=p,s=o.settings.cardsInHand,r={total:{player:s,opponent:s},list:y,nextPos:{player:s,opponent:s}};return(0,w.z)((0,h.of)({type:a.zn,payload:r}),(0,h.of)({type:a.s3,playersTurn:i}),(0,h.of)({type:a.F5,payload:(0,q.iT)(o.settings)}),t||n?(0,h.of)({type:a.KP,on:!0}):m.E,(0,h.of)({type:a.k4,owner:i?"player":"opponent"}),(0,h.of)({type:a.NX}).pipe((0,U.g)(0))).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.NX)),(0,l.M)(p),(0,d.b)((([p,o])=>{const t="connected_to_id"===o.multiplayer.status;let n;if(o.multiplayer.gameStarted)if(t){const e=(0,H.d)();n=(0,w.z)((0,h.of)({type:a.kp,n:e}),(0,h.of)({type:a.H8,kind:b.d,data:{type:a.M0,n:e}}))}else n=(0,h.of)({type:a.tM});else n=(0,h.of)({type:a.kp,n:(0,H.d)()});return(0,w.z)((0,h.of)({type:a.Ut,on:!0,locknumber:1}),n).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.M0)),(0,d.b)((e=>{const{n:p}=e;return x.I.enqueue(p),m.E})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.tM)),(0,d.b)((p=>{const o=x.I.dequeueAsync();return(0,Z.D)(o).pipe((0,d.b)((e=>(0,h.of)({type:a.kp,n:e}))),(0,u.R)(e.ofType(a.Cv)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.kp)),(0,l.M)(p),(0,d.b)((([p,o])=>{const{n:t}=p,n=o.game.playersTurn?"player":"opponent",i=o.multiplayer.gameStarted;return(0,z.Z)("deal",o.volume),(0,k.Z)(`${n} draws card ${t}`,"info"),(0,w.z)((0,h.of)({type:a.$Z,n:t}),(0,h.of)({type:a.Qo,lastOnly:!0}),(0,h.of)({type:a.B4,owner:n}).pipe((0,U.g)(E.Fi)),(0,h.of)({type:a.Ut,on:!1,locknumber:1}).pipe((0,U.g)(0)),"opponent"===n&&P.Hz&&!i?(0,h.of)({type:a.cx}).pipe((0,U.g)(E.RE+E.Oz+(P.G1?0:P.kQ))):m.E,"opponent"===n&&i?(0,h.of)({type:a.tI}).pipe((0,U.g)(E.RE+E.Oz)):m.E,"player"===n?(0,h.of)({type:a.yh}).pipe((0,U.g)(0)):m.E).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.jV)),(0,l.M)(p),(0,d.b)((([p,o])=>(0,w.z)((0,h.of)({type:a.K5}),(0,h.of)({type:a.k4,owner:o.game.playersTurn?"opponent":"player"}),(0,h.of)({type:a.Ut,on:!1}),(0,h.of)({type:a.NX}).pipe((0,U.g)(0)),(0,h.of)({type:a.Z$,on:!0})).pipe((0,u.R)(e.ofType(a.OU))))))),S.Z,((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.kH)),(0,l.M)(p),(0,N.zg)((([p,o])=>{const t=[],n=[],i=[];return I.forEach((e=>{o.cards.list.forEach(((p,o)=>{null!==p&&p.position===e&&(t.push((0,h.of)({type:a.EK,index:o})),n.push((0,h.of)({type:a.OK,index:o}).pipe((0,U.g)(E.RE))),i.push((0,h.of)({type:a.M2,index:o}).pipe((0,U.g)(2*E.RE))))}))})),(0,j.T)((0,h.of)({type:a.Z$,on:!1}),(0,j.T)(...t,...n,...i)).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.Qo)),(0,l.M)(p),(0,d.b)((([p,o])=>{const t=[],n=[],i=(e,i)=>{if(null!==e){const y=p.lastOnly?o.game.playersTurn?"player":"opponent":e.owner;if("common"!==y){const{type:p,cost:s}=O.Z[e.n];o.status[y][g.ag[p]]<s?e.unusable||t.push(i):e.unusable&&n.push(i)}}};if(p.lastOnly){const e=o.cards.list,p=e.length-1;i(e[p],p)}else o.cards.list.forEach(i);return(0,h.of)({type:a.R9,unusables:t,usables:n}).pipe((0,u.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.Dt)),(0,l.M)(p),(0,d.b)((([p,o])=>{const{winTower:t,winResource:n}=(0,q.Ib)(o.settings),{player:i,opponent:y}=o.status,s=i.tower>=t||y.tower<=0||g.ag.some((e=>i[e]>=n)),r=y.tower>=t||i.tower<=0||g.ag.some((e=>y[e]>=n));return s&&!r?(0,h.of)({type:a.Wz,payload:{type:"win"}}).pipe((0,u.R)(e.ofType(a.OU))):!s&&r?(0,h.of)({type:a.Wz,payload:{type:"lose"}}).pipe((0,u.R)(e.ofType(a.OU))):s&&r?(0,h.of)({type:a.Wz,payload:{type:"tie"}}).pipe((0,u.R)(e.ofType(a.OU))):m.E})))),X.Z,((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.cx)),(0,l.M)(p),(0,d.b)((([p,o])=>{const t=(0,$.ai)(o);if(null===t)return(0,h.of)({type:a.Wz,payload:{type:"win",surrender:!0}}).pipe((0,u.R)(e.ofType(a.OU)));const{index:n,use:i}=t,y=o.cards.list[n];if(null!==y&&"common"!==y.owner){const{n:p,position:o,owner:t}=y;return i?(0,h.of)({type:a.qr,index:n,n:p,position:o,owner:t}).pipe((0,u.R)(e.ofType(a.OU))):(0,h.of)({type:a.fL,index:n,position:o,owner:t}).pipe((0,u.R)(e.ofType(a.OU)))}return m.E})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.yh)),(0,l.M)(p),(0,d.b)((([p,o])=>0===(0,J.Z)(o,"player").filter((e=>e.canuse||e.candiscard)).length?(0,h.of)({type:a.Wz,payload:{type:"lose",surrender:!0}}).pipe((0,u.R)(e.ofType(a.OU))):m.E)))),L.Z,W.Z,C.Z,D.Z,K.Z,F.Z,Q.Z,V.Z,A.Z,B.Z,G.Z)}}]);