"use strict";(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[8761],{17474:function(e,p,t){t.d(p,{Z:function(){return ue}});var o=t(22915),n=t(47515),i=t(77102),r=t(40706),s=t(53110),a=t(23805),y=t(99381),l=t(99592),u=t(23201),f=t(94132),d=t(63211),c=t(94975),g=t(63428),m=t(87877),O=t(83505),Z=t(91757),w=t(15069),h=t(96559),z=t(90583),b=t(91304),x=t(32817),T=t(42034),N=t(1545),v=t(13875),R=t(66324),U=t(42006),E=t(20533),M=t(16306),k=t(17750),S=t(80127),P=t(45626),q=t(40052),$=t(29127),j=t(74727),H=t(20401),J=t(81317),B=t(60117);const _=[-2,-3,-4];var C=t(76320),D=t(67032),X=t(5078),I=t(77456),W=t(23644),L=t(6709),F=t(23071);const G=[-2,-3,-4];var Y=t(78373),A=t(74206),K=t(92119),Q=t(40898),V=t(84694),ee=t(7668),pe=t(37365),te=t(78410),oe=t(27360),ne=t(10228),ie=t(10441),re=t(74555),se=t(92087),ae=t(62884),ye=t(60751),le=t(29970),ue=(0,o.l)(n.Z,i.Z,r.Z,s.Z,a.Z,y.Z,l.Z,u.Z,f.Z,((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.Uk)),(0,g.M)(p),(0,m.z)((([p,t])=>{const o=t.status.player,n=t.status.opponent,i=Object.assign({},o),r=Object.assign({},n),s=z.Z[p.n],a="player"===p.owner?i:r,y=b.ag[s.type];a[y]-=s.cost;const l=a[y],u=s.effect;"player"===p.owner?u(i,r):u(r,i);const f=(0,h.qh)(i).filter((([e,p])=>p!==o[e])).map((([e,t])=>({isPlayer:!0,statusProp:e,to:t,noSound:"player"===p.owner&&e===y&&t===l}))).concat((0,h.qh)(r).filter((([e,p])=>p!==n[e])).map((([e,t])=>({isPlayer:!1,statusProp:e,to:t,noSound:"opponent"===p.owner&&e===y&&t===l}))));return(0,x.of)({type:d.g$,payload:f}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.qr)),(0,g.M)(p),(0,m.z)((([p,t])=>{const{n:o,index:n,position:i,owner:r}=p,s=t.multiplayer.gameNumber;return(0,T.z)((0,x.of)({type:d.xZ,payload:{type:d.ao,n:o,index:n,position:i,owner:r}}),s>0?(0,x.of)({type:d.H8,kind:v.d,data:{type:d.u3,payload:{type:d.ao,n:o,index:n,position:i,owner:(0,R._w)(r)}}}):N.E).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.u3)),(0,U.b)((e=>{const{payload:p,gameNumber:t}=e;if(void 0===t)return void(0,k.Z)(`gameNumber is undefined in ${JSON.stringify(e)}`,"error");let o=M.PB.get(t);void 0===o&&(o=new S.Z,M.PB.set(t,o)),o.enqueue(p)})),(0,E.l)())),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.tI)),(0,g.M)(p),(0,m.z)((([t,o])=>{const{gameNumber:n}=o.multiplayer;(0,k.Z)(`play card from queue: ${n.toString()}`,"info");let i=M.PB.get(n);void 0===i&&(i=new S.Z,M.PB.set(n,i));const r=i.dequeueAsync();return(0,q.D)(r).pipe((0,g.M)(p),(0,m.z)((([e,p])=>p.multiplayer.gameNumber===n?(0,x.of)({type:d.xZ,payload:e}).pipe((0,P.g)(0)):N.E)),(0,O.R)(e.pipe((0,w.l)(d.Cv))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.xZ)),(0,g.M)(p),(0,m.z)((([t,o])=>{const{payload:n}=t;return o.game.locked.some((e=>!0===e))?((0,k.Z)(`${JSON.stringify(n)} executed during the lock ${JSON.stringify(o.game.locked)}. the game will try to fix that`,"warning"),p.pipe((0,$.U)((e=>e.game.locked)),(0,c.h)((e=>!e.some((e=>!0===e)))),(0,j.q)(1),(0,$.U)((()=>n)),(0,O.R)(e.pipe((0,w.l)(d.Cv))))):(0,x.of)(n)})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.ao)),(0,g.M)(p),(0,m.z)((([p,t])=>{const{n:o,index:n,position:i,owner:r}=p,s=z.Z[o].special;return(0,H.h)("deal",null,t.sound.stereo?(0,B.Z)(t.cards.total[r],i):0),(0,T.z)(t.game.isNewTurn?(0,x.of)({type:d.kH}):N.E,(0,x.of)({type:d.Uk,n:o,owner:r}),(0,x.of)({type:d.PX,index:n}),(0,x.of)({type:d.fj,index:n,position:i,owner:r}),(0,x.of)({type:d.Ut,on:!0}),(null==s?void 0:s.drawDiscardPlayagain)?(0,T.z)((0,x.of)({type:d.vd,on:!0}),(0,x.of)({type:d.NX}).pipe((0,P.g)(0)),(0,x.of)({type:d.Jn,index:n}).pipe((0,P.g)(J.RE+J.Oz)),(0,x.of)({type:d.Ut,on:!1})):(0,T.z)((0,x.of)({type:d.Jn,index:n}).pipe((0,P.g)(J.RE+J.Oz)),(null==s?void 0:s.playagain)?(0,T.z)((0,x.of)({type:d.NX}).pipe((0,P.g)(0)),(0,x.of)({type:d.Ut,on:!1})):(0,x.of)({type:d.jV}).pipe((0,P.g)(J.RE)))).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.fL)),(0,g.M)(p),(0,m.z)((([p,t])=>{const{index:o,position:n,owner:i}=p,r=t.multiplayer.gameNumber;return(0,T.z)((0,x.of)({type:d.xZ,payload:{type:d.xr,index:o,position:n,owner:i}}),r>0?(0,x.of)({type:d.H8,kind:v.d,data:{type:d.u3,payload:{type:d.xr,index:o,position:n,owner:(0,R._w)(i)}}}):N.E).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.xr)),(0,g.M)(p),(0,m.z)((([p,t])=>{const{index:o,position:n,owner:i}=p;return(0,H.h)("deal",null,t.sound.stereo?(0,B.Z)(t.cards.total[i],n):0),(0,T.z)(t.game.isNewTurn?(0,x.of)({type:d.kH}):N.E,(0,x.of)({type:d.iE,index:o}),(0,x.of)({type:d.Jn,index:o}).pipe((0,P.g)(0)),(0,x.of)({type:d.fj,index:o,position:n,owner:i}),t.game.discardMode?(0,T.z)((0,x.of)({type:d.vd,on:!1}),(0,x.of)({type:d.NX}).pipe((0,P.g)(0))):(0,T.z)((0,x.of)({type:d.Ut,on:!0}),(0,x.of)({type:d.jV}).pipe((0,P.g)(J.RE)))).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.Jn)),(0,g.M)(p),(0,m.z)((([p,t])=>{const o=t.cards.list,n=o[p.index];if(null!==n&&!1===_.includes(n.position)){const t=_.find((e=>o.every((p=>(null==p?void 0:p.position)!==e))));return void 0===t?(0,T.z)((0,x.of)({type:d.kH}),(0,x.of)({type:d.Jn,index:p.index})).pipe((0,O.R)(e.pipe((0,w.l)(d.OU)))):(0,x.of)({type:d._d,index:p.index,toPosition:t}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))}return N.E})))),C.Z,D.Z,((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.qg)),(0,g.M)(p),(0,m.z)((([e,p])=>{const{fromScreenEnd:t=!1}=e,o=p.multiplayer.on&&"connected_to_id"===p.multiplayer.status,n=p.multiplayer.gameNumber,i=!o||t&&-1===n?-1:(new Date).getTime(),r=Math.random()<.5,s=[],a=p.settings.cardsInHand;for(let e=0,p=2*a;e<p;e++){const p={position:e%a,n:(0,X.d)(),unusable:!1,discarded:!1,isFlipped:!1,zeroOpacity:!1,owner:e<a?"player":"opponent"};s.push(p)}return(0,T.z)((0,x.of)({type:d.pS,playersTurn:r,cardList:s,gameNumber:i}),o?(0,x.of)({type:d.H8,kind:v.d,data:{type:t?d.S9:d.pS,playersTurn:!r,cardList:(0,R.b1)(s),gameNumber:i}}):N.E)})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.pS)),(0,g.M)(p),(0,m.z)((([e,p])=>{const{playersTurn:t,cardList:o,gameNumber:n}=e,i=p.settings.cardsInHand,r={total:{player:i,opponent:i},list:o,nextPos:{player:i,opponent:i}};return(0,T.z)((0,x.of)({type:d.Wz,payload:{type:null}}),(0,x.of)({type:d.OU}),(0,x.of)({type:d.zn,payload:r}),(0,x.of)({type:d.s3,playersTurn:t}),(0,x.of)({type:d.F5,payload:(0,I.iT)(p.settings)}),(0,x.of)({type:d.xD,n:n}),(0,x.of)({type:d.k4,owner:t?"player":"opponent"}),(0,x.of)({type:d.NX}).pipe((0,P.g)(0)))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.S9)),(0,U.b)((e=>{const{type:p,prevGameNumber:t}=e,o=function(e,p){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&p.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)p.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(t[o[n]]=e[o[n]])}return t}(e,["type","prevGameNumber"]);if(void 0===t)return void(0,k.Z)(`prevGameNumber is undefined in ${JSON.stringify(e)}`,"error");let n=M.YB.get(t);void 0===n&&(n=new S.Z,M.YB.set(t,n)),n.enqueue(o)})),(0,E.l)())),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.mv)),(0,g.M)(p),(0,m.z)((([t,o])=>{const{gameNumber:n}=o.multiplayer;(0,k.Z)(`init from queue: ${n.toString()}`,"info");let i=M.YB.get(n);void 0===i&&(i=new S.Z,M.YB.set(n,i));const r=i.dequeueAsync();return(0,q.D)(r).pipe((0,g.M)(p),(0,m.z)((([e,p])=>p.multiplayer.gameNumber===n?(0,x.of)(Object.assign({type:d.pS},e)).pipe((0,P.g)(0)):N.E)),(0,O.R)(e.pipe((0,w.l)(d.Cv))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.NX)),(0,g.M)(p),(0,m.z)((([p,t])=>{const o="connected_to_id"===t.multiplayer.status;let n;if(-1===t.multiplayer.gameNumber)n=(0,x.of)({type:d.kp,n:(0,X.d)()}).pipe((0,P.g)(0));else if(o){const e=(0,X.d)();n=(0,T.z)((0,x.of)({type:d.kp,n:e}).pipe((0,P.g)(0)),(0,x.of)({type:d.H8,kind:v.d,data:{type:d.M0,n:e}}))}else n=(0,x.of)({type:d.tM}).pipe((0,P.g)(0));return(0,T.z)((0,x.of)({type:d.Ut,on:!0,locknumber:1}),n).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.M0)),(0,U.b)((e=>{const{n:p,gameNumber:t}=e;if(void 0===t)return void(0,k.Z)(`gameNumber is undefined in ${JSON.stringify(e)}`,"error");let o=M.gZ.get(t);void 0===o&&(o=new S.Z,M.gZ.set(t,o)),o.enqueue(p)})),(0,E.l)())),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.tM)),(0,g.M)(p),(0,m.z)((([t,o])=>{const{gameNumber:n}=o.multiplayer;(0,k.Z)(`draw card from queue: ${n.toString()}`,"info");let i=M.gZ.get(n);void 0===i&&(i=new S.Z,M.gZ.set(n,i));const r=i.dequeueAsync();return(0,q.D)(r).pipe((0,g.M)(p),(0,m.z)((([e,p])=>p.multiplayer.gameNumber===n?(0,x.of)({type:d.kp,n:e}).pipe((0,P.g)(0)):N.E)),(0,O.R)(e.pipe((0,w.l)(d.Cv))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.kp)),(0,g.M)(p),(0,m.z)((([p,t])=>{const{n:o}=p,n=t.game.playersTurn?"player":"opponent",i=t.multiplayer.gameNumber;return(0,H.h)("deal",null,t.sound.stereo?(0,B.Z)(t.cards.total[n]+1,t.cards.nextPos[n]):0),(0,k.Z)(`${n} draws card ${o}`,"info"),(0,T.z)((0,x.of)({type:d.$Z,n:o}),(0,x.of)({type:d.Qo,lastOnly:!0}),(0,x.of)({type:d.B4,owner:n}).pipe((0,P.g)(J.Fi)),(0,x.of)({type:d.Ut,on:!1,locknumber:1}).pipe((0,P.g)(0)),"opponent"===n&&W.Hz&&-1===i?(0,x.of)({type:d.cx}).pipe((0,P.g)(J.RE+J.CF+(W.G1?0:W.kQ))):N.E,"opponent"===n&&i>0?(0,x.of)({type:d.tI}).pipe((0,P.g)(J.RE+J.t7)):N.E,"player"===n?(0,x.of)({type:d.yh}).pipe((0,P.g)(0)):N.E).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.jV)),(0,g.M)(p),(0,m.z)((([p,t])=>(0,T.z)((0,x.of)({type:d.K5}),(0,x.of)({type:d.k4,owner:t.game.playersTurn?"opponent":"player"}),(0,x.of)({type:d.Ut,on:!1}),(0,x.of)({type:d.NX}).pipe((0,P.g)(0)),(0,x.of)({type:d.Z$,on:!0})).pipe((0,O.R)(e.pipe((0,w.l)(d.OU)))))))),L.Z,((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.kH)),(0,g.M)(p),(0,m.z)((([p,t])=>{const o=[],n=[],i=[];return G.forEach((e=>{t.cards.list.forEach(((p,t)=>{null!==p&&p.position===e&&(o.push((0,x.of)({type:d.EK,index:t})),n.push((0,x.of)({type:d.OK,index:t}).pipe((0,P.g)(J.RE))),i.push((0,x.of)({type:d.M2,index:t}).pipe((0,P.g)(2*J.RE))))}))})),(0,F.T)((0,x.of)({type:d.Z$,on:!1}),(0,F.T)(...o,...n,...i)).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.Qo)),(0,g.M)(p),(0,m.z)((([p,t])=>{const o=[],n=[],i=(e,i)=>{if(null!==e){const r=p.lastOnly?t.game.playersTurn?"player":"opponent":e.owner;if("common"!==r){const{type:p,cost:s}=z.Z[e.n];t.status[r][b.ag[p]]<s?e.unusable||o.push(i):e.unusable&&n.push(i)}}};if(p.lastOnly){const e=t.cards.list,p=e.length-1;i(e[p],p)}else t.cards.list.forEach(i);return(0,x.of)({type:d.R9,unusables:o,usables:n}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.Dt)),(0,g.M)(p),(0,m.z)((([p,t])=>{const{winTower:o,winResource:n}=(0,I.Ib)(t.settings),{player:i,opponent:r}=t.status,s=i.tower>=o||r.tower<=0||b.ag.some((e=>i[e]>=n)),a=r.tower>=o||i.tower<=0||b.ag.some((e=>r[e]>=n));return s&&!a?(0,x.of)({type:d.Wz,payload:{type:"win"}}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU)))):!s&&a?(0,x.of)({type:d.Wz,payload:{type:"lose"}}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU)))):s&&a?(0,x.of)({type:d.Wz,payload:{type:"tie"}}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU)))):N.E})))),Y.Z,A.Z,((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.cx)),(0,g.M)(p),(0,m.z)((([p,t])=>{const o=(0,K.ai)(t);if(null===o)return(0,x.of)({type:d.Wz,payload:{type:"win",surrender:!0}}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))));const{index:n,use:i}=o,r=t.cards.list[n];if(null!==r&&"common"!==r.owner){const{n:p,position:t,owner:o}=r;return i?(0,x.of)({type:d.qr,index:n,n:p,position:t,owner:o}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU)))):(0,x.of)({type:d.fL,index:n,position:t,owner:o}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU))))}return N.E})))),((e,p)=>e.pipe((0,c.h)((0,Z.isOfType)(d.yh)),(0,g.M)(p),(0,m.z)((([p,t])=>0===(0,Q.Z)(t,"player").filter((e=>e.canuse||e.candiscard)).length?(0,x.of)({type:d.Wz,payload:{type:"lose",surrender:!0}}).pipe((0,O.R)(e.pipe((0,w.l)(d.OU)))):N.E)))),V.Z,ee.Z,pe.Z,te.Z,oe.Z,ne.Z,ie.Z,re.Z,se.Z,ae.Z,ye.Z,le.Z)}}]);