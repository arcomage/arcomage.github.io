(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[23],{1691:function(e,n,t){"use strict";var a=t(7294),l=t(8172),r=t(640),o=t.n(r),i=t(6360),c=t(3484),s=t(3211),u=t(4983),m=t(6838),p=t(8093),d=t(6559),b=t(1317),g=t(1304),y=t(7456),E=t(9451),h=t(2502),C=function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(e);l<a.length;l++)n.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(t[a[l]]=e[a[l]])}return t};n.Z=(0,a.memo)((()=>{const e=(0,a.useContext)(u.OO),n=(0,i.T)(),t=(0,a.useRef)(null),r=(0,a.useRef)(null),P=(0,i.C)((e=>e.multiplayer.on)),f=(0,i.C)((e=>e.multiplayer.yourId)),w=(0,i.C)((e=>e.multiplayer.status)),I=(0,i.C)((e=>e.multiplayer.tempFormFields)),v=(0,i.C)((e=>e.multiplayer.gameStarted)),N={playerName:(0,i.C)((e=>e.settings.playerName)),opponentName:(0,i.C)((e=>e.settings.opponentName)),tower:(0,i.C)((e=>e.settings.tower)),wall:(0,i.C)((e=>e.settings.wall)),bricks:(0,i.C)((e=>e.settings.bricks)),gems:(0,i.C)((e=>e.settings.gems)),recruits:(0,i.C)((e=>e.settings.recruits)),brickProd:(0,i.C)((e=>e.settings.brickProd)),gemProd:(0,i.C)((e=>e.settings.gemProd)),recruitProd:(0,i.C)((e=>e.settings.recruitProd)),winTower:(0,i.C)((e=>e.settings.winTower)),winResource:(0,i.C)((e=>e.settings.winResource)),cardsInHand:(0,i.C)((e=>e.settings.cardsInHand)),opponentId:(0,i.C)((e=>e.multiplayer.opponentId))},[_,k]=(0,a.useState)(N),O=e=>{const n=m.B.concat(p.he).findIndex((n=>(0,y.$)(e,n)));return n===m.B.length?-2:n},[x,S]=(0,a.useState)(-10),[$,T]=(0,a.useState)(""),[A,R]=(0,a.useState)(!1),[Y,M]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=_.tower+1,t=Math.max(_.bricks+_.brickProd,_.gems+_.gemProd,_.recruits+_.recruitProd)+1;if(_.winTower<e?k((n=>(0,l.ZP)(n,(n=>{n.winTower=e})))):_.winResource<t&&k((e=>(0,l.ZP)(e,(e=>{e.winResource=t})))),S(O(_)),Y){const{playerName:e,opponentName:t,opponentId:a}=_,l=C(_,["playerName","opponentName","opponentId"]);n({type:s.n9,payload:l})}}),(0,y.Ug)(_));const[j,Z]=(0,a.useState)(-10);(0,a.useEffect)((()=>{Z(O(I))}),(0,y.Ug)(I)),(0,a.useEffect)((()=>{if(Y||A){const{playerName:e}=_;n({type:s.n9,payload:{playerName:e}})}}),[_.playerName]);const q=(0,a.useRef)("");(0,a.useEffect)((()=>{if("connecting_to_id"!==q.current&&"connected_net"!==q.current||"connected_to_id"!==w){if(""!==q.current&&"connected_by_id"===w){const{playerName:e}=_;n({type:s.n9,payload:{playerName:e}})}}else{const{opponentName:e,opponentId:t}=_,a=C(_,["opponentName","opponentId"]);n({type:s.n9,payload:a})}q.current=w}),[w,N.opponentId]),(0,a.useEffect)((()=>{k((e=>(0,l.ZP)(e,(e=>{e.opponentId=N.opponentId}))))}),[N.opponentId]);const D=e=>{const{name:n,type:t,min:a,max:r}=e.target;let{value:o}=e.target;"number"===t&&(""===o&&(o="0"),parseInt(o,10)<parseInt(a,10)&&(o=a),parseInt(e.target.value,10)>parseInt(r,10)&&(o=r)),k((e=>(0,l.ZP)(e,(e=>{if((0,d.nr)(e,n))switch(t){case"text":e[n]=o;break;case"number":e[n]=parseInt(o,10)}}))))};return(0,a.useEffect)((()=>{switch(w){case"connecting_net":T(e.i18n("Connecting to the network âŒ›"));break;case"connected_net":T(e.i18n("Connected to the network (but not to anyone) âœ”ï¸"));break;case"connecting_to_id":{const n=_.opponentId,t=n.length>10?`${n.substring(0,b._h)}...${n.substring(n.length-b._h)}`:n;T(e.i18n("Connecting to ID %s âŒ›").replace("%s",t));break}case"connected_to_id":{const n=_.opponentId,t=`${n.substring(0,b._h)}...${n.substring(n.length-b._h)}`;T(e.i18n("Connected to ID %s âœ”ï¸ You're the host ðŸ ").replace("%s",t));break}case"connected_by_id":{const n=N.opponentId,t=`${n.substring(0,b._h)}...${n.substring(n.length-b._h)}`;T(e.i18n("Connected by ID %s âœ”ï¸ You're the guest ðŸ’¼").replace("%s",t));break}case"failed":T(e.i18n("Connection failed âŒ"));break;case"disconnected":T(e.i18n("Disconnected ðŸ”Œ"))}R(P&&"connected_by_id"===w),M(P&&"connected_to_id"===w)}),[w,e]),a.createElement(c.Z,{screenActionType:s.fy,onCancel:()=>{if(Y){const{opponentName:e,opponentId:t}=N,a=C(N,["opponentName","opponentId"]);n({type:s.n9,payload:a})}if(A){const{playerName:e}=N;n({type:s.n9,payload:{playerName:e}})}}},a.createElement("h3",{className:"preferences"},e.i18n("Preferences"),e.i18n(": "),a.createElement("span",{id:"opponentNotification"},v?e.i18n("You are playing against human"):e.i18n("You are playing against computer AI"))),a.createElement("div",{className:"two-column half"},a.createElement("label",null,a.createElement("span",null,e.i18n("Your Name"),e.i18n(": ")),a.createElement("input",{type:"text",name:g.$Y[0],id:g.$Y[0],value:_.playerName,onChange:D,onFocus:e=>{(0,h.Z)(e.target.value)&&e.target.select()}})),a.createElement("label",null,a.createElement("span",null,e.i18n("Opponent's Name"),e.i18n(": ")),a.createElement("input",{type:"text",name:g.$Y[1],id:g.$Y[1],disabled:A||Y,value:(A||Y)&&null!==I?I.opponentName:_.opponentName,onChange:D,onFocus:e=>{(0,h.Z)(e.target.value)&&e.target.select()}}))),a.createElement("label",{className:"one-colume"},a.createElement("span",null,e.i18n("Choose a Tavern (Preset Preferences)"),e.i18n(": ")),a.createElement("select",{name:"tavern",id:"tavern",value:A?j:x,disabled:A,onChange:e=>{(e=>{const n=-2===e?m.B.length:e;if(n>=0){const e=m.B.concat(p.he)[n];k((n=>Object.assign(Object.assign({},n),e)))}})(parseInt(e.target.value,10))}},a.createElement("option",{value:-2},e.i18n("Default")),m.B.map(((n,t)=>a.createElement("option",{value:t,key:t},e.taverns(t,"name")," - ",e.taverns(t,"location")))),(-1===x||A)&&a.createElement("option",{value:-1},e.i18n("Customized")))),a.createElement("h4",null,e.i18n("Starting Conditions"),e.i18n(": ")),a.createElement("div",{className:"four-column"},a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("tower"))),a.createElement("input",{type:"number",name:g.PO[0],id:g.PO[0],min:"1",disabled:A,value:A&&null!==I?I.tower:_.tower,onChange:D})),a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("bricks"))),a.createElement("input",{type:"number",name:g.PO[2],id:g.PO[2],min:"0",disabled:A,value:A&&null!==I?I.bricks:_.bricks,onChange:D})),a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("gems"))),a.createElement("input",{type:"number",name:g.PO[3],id:g.PO[3],min:"0",disabled:A,value:A&&null!==I?I.gems:_.gems,onChange:D})),a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("recruits"))),a.createElement("input",{type:"number",name:g.PO[4],id:g.PO[4],min:"0",disabled:A,value:A&&null!==I?I.recruits:_.recruits,onChange:D}))),a.createElement("div",{className:"four-column"},a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("wall"))),a.createElement("input",{type:"number",name:g.PO[1],id:g.PO[1],min:"0",disabled:A,value:A&&null!==I?I.wall:_.wall,onChange:D})),a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("quarry"))),a.createElement("input",{type:"number",name:g.PO[5],id:g.PO[5],min:"1",disabled:A,value:A&&null!==I?I.brickProd:_.brickProd,onChange:D})),a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("magic"))),a.createElement("input",{type:"number",name:g.PO[6],id:g.PO[6],min:"1",disabled:A,value:A&&null!==I?I.gemProd:_.gemProd,onChange:D})),a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("dungeon"))),a.createElement("input",{type:"number",name:g.PO[7],id:g.PO[7],min:"1",disabled:A,value:A&&null!==I?I.recruitProd:_.recruitProd,onChange:D}))),a.createElement("h4",null,e.i18n("Victory Conditions"),e.i18n(": ")),a.createElement("div",{className:"two-column"},a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("tower"))),a.createElement("input",{type:"number",name:g.qA[0],id:g.qA[0],min:(_.tower+1).toString(10),disabled:A,value:A&&null!==I?I.winTower:_.winTower,onChange:D})),a.createElement("label",null,a.createElement("span",null,(0,u.mP)(e.i18n("resource"))),a.createElement("input",{type:"number",name:g.qA[1],id:g.qA[1],min:(Math.max(_.bricks+_.brickProd,_.gems+_.gemProd,_.recruits+_.recruitProd)+1).toString(10),disabled:A,value:A&&null!==I?I.winResource:_.winResource,onChange:D}))),a.createElement("h4",null,e.i18n("Other Preferences"),e.i18n(": ")),a.createElement("label",{className:"one-colume"},a.createElement("span",null,e.i18n("Cards in Hand")),a.createElement("input",{type:"number",name:g.qA[2],id:g.qA[2],min:"0",max:"15",disabled:A,value:A&&null!==I?I.cardsInHand:_.cardsInHand,onChange:D})),a.createElement("h4",{className:"multiplayer"},a.createElement("label",null,a.createElement("input",{type:"checkbox",name:"isMultiplayer",id:"isMultiplayer",checked:P,onChange:e=>{n({type:s.LM,on:e.target.checked})}}),a.createElement("span",null,e.i18n("Multiplayer"),a.createElement("span",{title:e.i18n("Multiplayer Mode is experimental and unstable")},"ðŸ§ª"),e.i18n(": "),(P?e.i18n("on"):e.i18n("off")).toUpperCase())),a.createElement("span",{id:"multiplayerNotification"},$)),a.createElement("div",{className:"multiplayer"},a.createElement("label",null,a.createElement("span",null,e.i18n("Your ID"),e.i18n(": ")),a.createElement("input",{type:"text",name:"yourId",id:"yourId",value:f,readOnly:!0,onClick:e=>{const n=e.target;""!==n.value&&(n.select(),o()(n.value),null!==t.current&&(t.current.classList.add("copied-shown"),null!==r.current&&clearTimeout(r.current),r.current=setTimeout((()=>{null!==t.current&&t.current.classList.remove("copied-shown")}),b.J8)))}}),a.createElement("span",{ref:t,className:"copied"},e.i18n("Copied ðŸ“‹âœ”ï¸")))),a.createElement("div",{className:"multiplayer"},a.createElement("label",null,a.createElement("span",null,e.i18n("Enter your opponent's ID"),e.i18n(": ")),a.createElement("input",{disabled:!P||"connecting_net"===w||"connecting_to_id"===w||"connected_to_id"===w||"connected_by_id"===w,type:"text",name:"opponentId",id:"opponentId",value:_.opponentId,onChange:D})),a.createElement("button",{disabled:!P||"connecting_net"===w||"connecting_to_id"===w||"connected_to_id"===w||"connected_by_id"===w,className:"highlight",onClick:e=>{n({type:s.$u,id:_.opponentId})}},e.i18n("Connect"))),a.createElement("div",{className:"button-wrapper"},a.createElement("button",{disabled:A,onClick:()=>{k((({opponentId:e})=>Object.assign(Object.assign({playerName:(0,E.UP)(p.yk),opponentName:(0,E.UP)(p.eA)},p.he),{isMultiplayer:P,yourId:f,opponentId:e})))}},e.i18n("Reset")),a.createElement("button",{disabled:A,className:"warning",onClick:()=>{n({type:s.fy,show:!1});const{opponentId:e}=_,t=C(_,["opponentId"]);n({type:s.cQ,payload:t})}},e.i18n("Apply & New Game"))))}))}}]);