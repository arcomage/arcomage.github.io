(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[376],{4107:function(e,t,r){"use strict";r.d(t,{ai:function(){return l}});var a=r(3644),n=r(583),o=r(1304),i=r(6559),c={bricks:1,gems:1.28,recruits:1.05,brickProd:18,gemProd:23.04,recruitProd:18.9,tower:3.67,wall:2.02,playagain:46,drawDiscardPlayagain:27.6,undiscardable:2.03,useDiscardRatio:2.18,loseDeduction:999,enemy:1.08,randomDice:100};const l=e=>((e,t,r)=>{const{player:a,opponent:l}=t;for(const t of e){t.score=0;const{index:e,n:s,canuse:d}=t,m=n.Z[s],{type:u,cost:p,special:g,effect:b}=m,{tower:h,resource:f}=r,y=Object.assign({},a),w=Object.assign({},l);b(w,y);const x=w.tower>=h||w.bricks>=f||w.gems>=f||w.recruits>=f||y.tower<=0,$=y.tower>=h||y.bricks>=f||y.gems>=f||y.recruits>=f||w.tower<=0;if(d&&x&&!$)return{index:e,use:!0};if(d&&x&&$)return{index:e,use:!0};const v=(0,i.sq)((0,i.qh)(l).map((([e,t])=>[e,w[e]-t]))),k=(0,i.sq)((0,i.qh)(a).map((([e,t])=>[e,y[e]-t])));v[o.ag[u]]-=p;const E=o.PO.map((e=>v[e]*c[e])).reduce(((e,t)=>e+t),0),C=o.PO.map((e=>k[e]*c[e]*c.enemy)).reduce(((e,t)=>e+t),0);t.score+=E-C,(null==g?void 0:g.playagain)&&(t.score+=c.playagain),(null==g?void 0:g.drawDiscardPlayagain)&&(t.score+=c.drawDiscardPlayagain),(null==g?void 0:g.undiscardable)&&(t.score+=c.undiscardable),$&&(t.score-=c.loseDeduction)}const s=e.map(((e,t)=>({card:e,use:!0,scoreAll:e.score}))),d=e.map(((e,t)=>({card:e,use:!1,scoreAll:e.score/c.useDiscardRatio*-1}))),m=s.concat(d).filter((e=>e.use&&e.card.canuse||!e.use&&e.card.candiscard));0===m.length&&console.error("AI cannot find any usable or discardable card!");const u=m.reduce(((e,t)=>e.scoreAll>t.scoreAll?e:t));return{index:u.card.index,use:u.use}})((e=>{const{locked:t,discardMode:r}=e.game,o=e.cards.list,i=[];return o.forEach(((e,o)=>{var c,l;if(null!==e&&"opponent"===e.owner){let s=!1,d=!1;const{n:m}=e;t||(r?!a.rd&&(null===(c=n.Z[m].special)||void 0===c?void 0:c.undiscardable)||(d=!0):e.unusable||(s=!0)),!t&&(!(null===(l=n.Z[m].special)||void 0===l?void 0:l.undiscardable)||r&&a.rd)&&(d=!0),i.push({index:o,n:m,score:0,canuse:s,candiscard:d})}})),i})(e),e.status,e.settings.win)},8523:function(e,t,r){"use strict";r.d(t,{Z:function(){return ue}});var a=r(7294),n=r(4184),o=r.n(n),i=r(7889),c=r(6360),l=r(8255),s=r(8023),d=r(6399),m=r(7379),u=r(5837),p=r(6905),g=r(4983);const b=(e,t)=>{const r=e*t;return r>=12?r:12},h=(e,t)=>1.2*b(e,t),f=e=>`(${e}px - 1.25rem * 2 - (1.75rem + 0.25rem * 2 + 1rem) - (0.25rem * 2 + ${h(e,.036)}px + 0.25rem + 0.75rem) * 3) / 3`,y=e=>`${f(e)} / 0.7222222222222222 + 0.25rem * 2 + 1.25rem * 2`,w=(0,i.QM)({brick:{background:{image:`url(${m.Z})`}},gem:{background:{image:`url(${u.Z})`}},recruit:{background:{image:`url(${p.Z})`}},prod:{"font-size":e=>`${b(e,.05)}px`,"line-height":e=>`${h(e,.05)}px`,"margin-bottom":"-0.2em"},count:{"font-size":e=>`${b(e,.036)}px`,"line-height":e=>`${h(e,.036)}px`,height:e=>`${h(e,.036)}px`},unit:{"font-size":e=>`${b(e,.036)}px`,"line-height":e=>`${h(e,.036)}px`,height:e=>`${h(e,.036)}px`}});var x=(0,a.memo)((({type:e,count:t,prod:r})=>{const n=(0,a.useContext)(g.I18nContext),i=(0,a.useContext)(l.$K).height/3*2,c=w(i),m={brick:"red",gem:"blue",recruit:"green"}[e],u={brick:n.i18n("bricks"),gem:n.i18n("gems"),recruit:n.i18n("recruits")}[e];return a.createElement("div",{className:o()("mb-3 p-1 shadow-lg",`bg-${m}-300`)},a.createElement("div",{className:o()(c[e],"bg-no-repeat bg-cover bg-center border border-l-darkborder border-t-darkborder border-r-lightborder border-b-lightborder relative"),style:{height:`calc(${f(i)})`}},a.createElement("div",{className:o()("text-yellow-400 absolute bottom-1 left-1 text-shadow-md tracking-tighter","fatnumber",c.prod)},a.createElement(d.Z,{n:r}),a.createElement(s.Z,{n:r}))),a.createElement("div",{className:"flow-root mt-1"},a.createElement("div",{className:o()("float-left text-black flex-1 text-left relative tracking-tighter","fatnumber",c.count)},a.createElement(d.Z,{n:t}),a.createElement(s.Z,{n:t})),a.createElement("div",{className:o()("float-right text-black flex-1 text-right","robotocondensed",c.unit)},u)))}));const $=(0,i.QM)({username:{"transition-property":"color, border-color","transition-timing-function":"ease-in-out","transition-duration":"0.3s"}});var v=(0,a.memo)((({playerName:e,bricks:t,gems:r,recruits:n,brickProd:i,gemProd:s,recruitProd:d,isOpponent:m=!1})=>{const u=(0,c.C)((e=>e.game.playersTurn)),p=(0,a.useContext)(l.$K).height/3*2,g=$();return a.createElement("div",{className:"z-20 p-5 h-full relative",style:{width:`calc(${y(p)})`,float:m?"right":"left"}},a.createElement("div",{className:"bg-black bg-opacity-50 mb-4 p-1 shadow-lg"},a.createElement("div",{className:o()("border border-yellow-400 text-yellow-400 text-center h-7 leading-7 font-mono",{"border-opacity-25 text-opacity-25":u===m},g.username)},e)),a.createElement(x,{type:"brick",count:t,prod:i}),a.createElement(x,{type:"gem",count:r,prod:s}),a.createElement(x,{type:"recruit",count:n,prod:d}))})),k=r(9624),E=r(7535),C=r(7221),N=r(6589);const Z=e=>`(${e}px - (1.75rem + 0.25rem * 2)) / (282 + 600)`,P=e=>`${Z(e)} * 204`,z=e=>`${Z(e)} * ((204 - 135) / 2)`,F=(e,t)=>`calc((${P(e)} - ${z(e)} * 2) / 135 * 600 * ${t})`,O=(0,i.QM)({main:{width:({height:e})=>`calc(${P(e)})`},towerwrapper:{height:({height:e})=>F(e,1),bottom:"calc(1.75rem + 0.25rem * 2)","padding-left":({height:e})=>`calc(${z(e)})`,"padding-right":({height:e})=>`calc(${z(e)})`},towerbody:{background:{image:`url(${E.Z})`,repeat:"repeat-y",size:"100%",position:"center 0"},width:({height:e})=>`calc(100% - ${z(e)} * 2)`,height:({height:e,current:t,goal:r})=>F(e,t/r),"max-height":({height:e})=>F(e,1),"will-change":"height","transition-property":"height","transition-timing-function":"linear","transition-duration":"0.4s","&:before":{content:'""',position:"absolute",top:({height:e})=>`calc(0px - ${P(e)} / 204 * 282 + 1px)`,left:({height:e})=>`calc(0px - ${z(e)})`,right:({height:e})=>`calc(0px - ${z(e)})`,width:({height:e})=>`calc(${P(e)})`,height:({height:e})=>`calc(${P(e)} / 204 * 282)`,display:"block",background:{repeat:"no-repeat",size:"100%",position:"center 0"}}},towerbodyred:{"&:before":{background:{image:`url(${C.Z})`}}},towerbodyblue:{"&:before":{background:{image:`url(${N.Z})`}}}});var M=(0,a.memo)((({isOpponent:e=!1,goal:t,current:r})=>{const n=(0,a.useContext)(l.$K).height/3*2,i=O({height:n,current:r,goal:t});return a.createElement("div",{className:o()("h-full mx-1 relative","float-"+(e?"right":"left"),i.main)},a.createElement("div",{className:o()("z-20 w-full absolute",i.towerwrapper)},a.createElement("div",{className:o()("absolute bottom-0",i.towerbody,i[e?"towerbodyblue":"towerbodyred"])})),a.createElement("div",{className:"bg-black bg-opacity-50 p-1 shadow-lg w-full absolute bottom-0"},a.createElement("div",{className:"border border-yellow-400 border-opacity-25 text-yellow-400 text-center h-7 leading-7 font-mono"},a.createElement(d.Z,{n:r}),a.createElement(s.Z,{n:r}),a.createElement(k.Z,{n:r}))))})),D=r(4399);const L=e=>`(${e}px - (1.75rem + 0.25rem * 2)) / (282 + 600)`,X=(e,t)=>`calc(${L(e)} * 597 * ${t/100})`,I=(0,i.QM)({main:{width:e=>`calc(${L(e)} * 72 + 1rem * 2)`},wallwrapper:{height:e=>X(e,100),bottom:"calc(1.75rem + 0.25rem * 2)"},wallbody:{background:{image:`url(${D.Z})`,repeat:"repeat-y",size:"100%",position:"center 0"},width:e=>`calc(${L(e)} * 72)`,"max-height":e=>`calc(${L(e)} * 597)`,"will-change":"height","transition-property":"height","transition-timing-function":"linear","transition-duration":"0.4s"}});var Q=(0,a.memo)((({current:e,isOpponent:t=!1})=>{const r=(0,a.useContext)(l.$K).height/3*2,n=I(r);return a.createElement("div",{className:o()("h-full mx-2 relative","float-"+(t?"right":"left"),n.main)},a.createElement("div",{className:o()("z-20 w-full absolute px-4",n.wallwrapper)},a.createElement("div",{className:o()("absolute bottom-0",n.wallbody),style:{height:X(r,e)}})),a.createElement("div",{className:"bg-black bg-opacity-50 p-1 shadow-lg w-full absolute bottom-0"},a.createElement("div",{className:"border border-yellow-400 border-opacity-25 text-yellow-400 text-center h-7 leading-7 font-mono"},a.createElement(d.Z,{n:e}),a.createElement(s.Z,{n:e}),a.createElement(k.Z,{n:e}))))})),j=r(7977),K=r(5755);const A=(0,i.QM)({main:{background:{image:`url(${K.Z})`,repeat:"no-repeat",size:"cover",position:"center 30%"}}});var H=(0,a.memo)((()=>{const e=(0,c.C)((e=>e.settings.playerName)),t=(0,c.C)((e=>e.settings.opponentName)),r=(0,c.C)((e=>e.status.player.bricks)),n=(0,c.C)((e=>e.status.player.gems)),i=(0,c.C)((e=>e.status.player.recruits)),l=(0,c.C)((e=>e.status.player.brickProd)),s=(0,c.C)((e=>e.status.player.gemProd)),d=(0,c.C)((e=>e.status.player.recruitProd)),m=(0,c.C)((e=>e.status.player.tower)),u=(0,c.C)((e=>e.status.player.wall)),p=(0,c.C)((e=>e.status.opponent.bricks)),g=(0,c.C)((e=>e.status.opponent.gems)),b=(0,c.C)((e=>e.status.opponent.recruits)),h=(0,c.C)((e=>e.status.opponent.brickProd)),f=(0,c.C)((e=>e.status.opponent.gemProd)),y=(0,c.C)((e=>e.status.opponent.recruitProd)),w=(0,c.C)((e=>e.status.opponent.tower)),x=(0,c.C)((e=>e.status.opponent.wall)),$=A();return a.createElement("div",{className:o()("z-0 h-2/3 flex-auto bg-green-100 relative",$.main)},a.createElement(v,{playerName:e,bricks:r,gems:n,recruits:i,brickProd:l,gemProd:s,recruitProd:d}),a.createElement(M,{goal:100,current:m}),a.createElement(Q,{current:u}),a.createElement(v,{playerName:t,bricks:p,gems:g,recruits:b,brickProd:h,gemProd:f,recruitProd:y,isOpponent:!0}),a.createElement(M,{isOpponent:!0,goal:100,current:w}),a.createElement(Q,{isOpponent:!0,current:x}),a.createElement(j.Z,null))})),R=r(3211),q=r(1317),_=r(604),B=r(583),S=r(1626),T=r(6409),Y=r(6228),W=r(8011),G=r(288),J=r(3644),U=r(3543);const V=({unusable:e,zeroOpacity:t})=>t?0:e?q.fv:1,ee=(0,i.QM)({main:{width:({cardPos:e})=>null==e?void 0:e.width,height:({cardPos:e})=>null==e?void 0:e.height,top:({cardPos:e,total:t,position:r})=>null==e?void 0:e[t===e.total?"top":"topM1"][r+5],left:({cardPos:e,total:t,position:r})=>null==e?void 0:e[t===e.total?"left":"leftM1"][r+5],"will-change":"transform, left, top, box-shadow","transition-property":"opacity, transform, left, top, box-shadow","transition-timing-function":"ease-in-out","transition-duration":`${q.Lc}ms`},isflipped:{transform:"translateX(-100%) rotateY(-179.99deg)"},cardeffect:{"transform-style":"preserve-3d","transform-origin":"center right"},cardfront:{"background-image":`url(${S.Z})`,"backface-visibility":"hidden",opacity:V,"will-change":"transform, left, top, box-shadow","transition-property":"opacity, transform, left, top, box-shadow","transition-timing-function":"ease-in-out","transition-duration":`${q.Lc}ms`,"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${q.CF}, ${q.CF}, ${q.CF}, ${q.LX}), rgba(0, 0, 0, 0), rgba(${q.CF}, ${q.CF}, ${q.CF}, ${q.LX}))`}},unusableopacity:{opacity:q.fv},cardback:{background:{image:`url(${T.Z})`,size:"cover",position:"center",repeat:"no-repeat"},opacity:V,"will-change":"transform, left, top, box-shadow","transition-property":"opacity, transform, left, top, box-shadow","transition-timing-function":"ease-in-out","transition-duration":`${q.Lc}ms`,"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${q.CF}, ${q.CF}, ${q.CF}, ${q.LX}), rgba(0, 0, 0, 0), rgba(${q.CF}, ${q.CF}, ${q.CF}, ${q.LX}))`}},cardbackeffect:{transform:"translateX(0) rotateY(180deg)","backface-visibility":"hidden"},cardbackhard:{background:{image:`url(${T.Z})`,size:"cover",position:"center",repeat:"no-repeat"},"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${q.CF}, ${q.CF}, ${q.CF}, ${q.LX}), rgba(0, 0, 0, 0), rgba(${q.CF}, ${q.CF}, ${q.CF}, ${q.LX}))`}},image:{height:"calc((100% / 63 * 47 - 0.5rem) / 22 * 13)"},text:{height:"calc(100% - (1.25rem + 0.25rem + 0.25rem) - (0.5rem + 0.5rem) - (100% / 63 * 47 - 0.5rem) / 22 * 13)"},resbg:{"background-image":({type:e})=>void 0===e?"none":`url(${[Y.Z,W.Z,G.Z][e]})`,background:{repeat:"no-repeat",size:"cover",position:"center center"},opacity:q.Em}});var te=(0,a.memo)((({n:e,unusable:t=!1,discarded:n=!1,position:i,owner:l="common",index:s=-1,isFlipped:d=!1,zeroOpacity:m=!1})=>{const u=(0,a.useContext)(g.I18nContext),p=(0,c.C)((e=>e.game.playersTurn)),b=(0,c.C)((e=>e.game.locked)),h=(0,c.C)((e=>e.game.discardMode)),f=(0,a.useRef)(null),y=(0,c.C)((e=>e.cards.total)),w=(0,c.T)(),x=(0,a.useContext)(U._),$="common"===l?y[p?"player":"opponent"]:y[l];if(-1===e||J.E5&&"opponent"===l){const r=ee({cardPos:x,total:$,position:i,unusable:t,zeroOpacity:m});return a.createElement("button",{ref:f,disabled:!0,className:o()(r.main,r.cardbackhard,"transform absolute rounded shadow-lg",{"opacity-0 pointer-events-none":p&&"opponent"===l||!p&&"player"===l,[r.unusableopacity]:-1===e})})}{const{type:c,cost:g,special:y}=B.Z[e],v=ee({cardPos:x,total:$,position:i,type:c,unusable:t,zeroOpacity:m}),k=["red","blue","green"][c];let E=!0;const C=()=>{"common"!==l&&w({type:R.u3,n:e,index:s,position:i,owner:l})},N=()=>{"common"!==l&&w({type:R.fL,index:s,position:i,owner:l})},Z=(()=>{if(!("common"===l||b||J.Hz&&"opponent"===l))if(h){if(J.rd||!(null==y?void 0:y.undiscardable))return E=!1,{onClick:N}}else if(!t)return E=!1,{onClick:C};return{}})(),P="common"===l||b||!(!(null==y?void 0:y.undiscardable)||h&&J.rd)||J.Hz&&"opponent"===l?{}:(E=!1,{onContextMenu:e=>{e.preventDefault(),N()}});return(p&&"opponent"===l||!p&&"player"===l)&&(E=!0),a.createElement("button",Object.assign({ref:f,className:o()(v.main,v.cardeffect,{[v.isflipped]:d},"transform absolute rounded",{"opacity-0 pointer-events-none":p&&"opponent"===l||!p&&"player"===l},{"shadow-lg":-1!==i},{"cursor-pointer hover:scale-105":i>=0}),accessKey:!E&&i>=0&&i<9?(i+1).toString(10):"",tabIndex:E?-1:i+1,disabled:E},Z,P,{onKeyDown:e=>{if("Delete"===e.key||"Backspace"===e.key){const e=f.current;if(e){const t=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!1,view:window,button:2,buttons:0,clientX:e.getBoundingClientRect().x,clientY:e.getBoundingClientRect().y});e.dispatchEvent(t)}}}}),a.createElement("div",{className:o()(v.cardfront,"absolute top-0 bottom-0 left-0 right-0 rounded",`bg-${k}-300`)},a.createElement("div",{className:o()("m-1 shadow text-center font-bold leading-5 h-5",`bg-${k}-200`)},u.cards(e,"name")),a.createElement("div",{className:o()(v.image,"m-1 shadow bg-no-repeat bg-cover bg-center flex justify-center items-center text-red-600 text-xl font-bold uppercase text-shadow-stroke"),style:{backgroundImage:`url(${r(5303)(`./${B.Z[e].type.toString()}_${(e%_.o).toString()}.png`).default})`}},n&&u.i18n("discarded")),a.createElement("div",{className:o()(v.text,"m-2 flex flex-wrap content-center justify-center")},a.createElement("div",{className:"leading-none break-words text-center"},u.cards(e,"desc"))),a.createElement("div",{className:"absolute bottom-1 right-1 w-9 h-9 leading-9 text-center font-bold"},a.createElement("div",{className:o()(v.resbg,"absolute top-0 left-0 w-full h-full")}),a.createElement("div",{className:"absolute top-0 left-0 w-full h-full"},g))),a.createElement("div",{className:o()(v.cardback,v.cardbackeffect,"absolute top-0 bottom-0 left-0 right-0 rounded")}))}})),re=r(515);const ae=(0,i.QM)({main:{background:{image:"linear-gradient(#326a4b, #000 2rem)"}}});var ne=(0,a.memo)((()=>{const e=(0,c.C)((e=>e.cards.list)),t=(0,c.C)((e=>e.settings.cardsInHand)),r=(0,c.C)((e=>e.game.discardMode)),n=(0,a.useContext)(l.$K),i=n.height,s=n.width,d=ae();return a.createElement(U.f,{cardsInHand:t,winHeight:i,winWidth:s},a.createElement("div",{className:o()(d.main,"h-1/3 flex-auto")},a.createElement(te,{n:-1,position:-1,unusable:!0}),e.map(((e,t)=>null===e?null:a.createElement(te,Object.assign({key:t,index:t},e)))),a.createElement(re.Z,{shown:r})))})),oe=r(6347),ie=r(6194),ce=r(6657),le=r(6499),se=r(1786),de=r(5586);const me=(0,i.QM)({main:{"min-width":`${l.ih}px`,"min-height":`${l.jw}px`}});var ue=(0,a.memo)((()=>{const e=me(),t=(0,c.C)((e=>e.screen.pref)),r=(0,c.C)((e=>e.screen.langPref)),n=(0,c.C)((e=>e.screen.volumePref)),i=(0,c.C)((e=>e.screen.end)),l=(0,c.C)((e=>e.screen.help)),s=(0,c.C)((e=>e.lang.erathian));return a.createElement("div",{className:o()("w-screen h-screen flex flex-col bg-black overflow-x-hidden select-none",{erathian:s},e.main),tabIndex:-1},a.createElement(H,null),a.createElement(ne,null),null!==i&&a.createElement(ie.Z,{kind:i}),t&&a.createElement(ce.Z,null),r&&a.createElement(le.Z,null),n&&a.createElement(se.Z,null),l&&a.createElement(de.Z,null),a.createElement(oe.Z,null))}))}}]);