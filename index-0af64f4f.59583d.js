(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[8761],{98300:function(e,p,o){"use strict";o.d(p,{Z:function(){return oe}});var t=o(84454),n=o(47515),i=o(77102),y=o(40706),s=o(23201),r=o(94132),a=o(63211),f=o(66008),l=o(43825),u=o(13251),d=o(1558),c=o(91757),g=o(96559),T=o(90583),m=o(91304),O=o(18170),h=o(6353),w=o(5631),b=o(13875),x=o(66324),Z=o(16306),U=o(55709),R=o(55760),k=o(51015),z=o(17750),E=o(55022),M=o(71159),N=o(81317);const v=[-2,-3,-4];var H=o(76320),q=o(67032),_=o(5078),P=o(77456),$=o(23644),j=o(6709),I=o(47746),J=o(14370);const S=[-2,-3,-4];var X=o(78373),C=o(55863),D=o(40898),L=o(84694),W=o(87878),F=o(37365),K=o(78410),Q=o(27360),V=o(10228),A=o(10441),B=o(74555),G=o(92087),Y=o(62884),ee=o(60751),pe=o(29970),oe=(0,t.l)(n.Z,i.Z,y.Z,s.Z,r.Z,((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.Uk)),(0,l.M)(p),(0,u.b)((([p,o])=>{const t=o.status.player,n=o.status.opponent,i=Object.assign({},t),y=Object.assign({},n),s=T.Z[p.n],r="player"===p.owner?i:y,f=m.ag[s.type];r[f]-=s.cost;const l=r[f],u=s.effect;"player"===p.owner?u(i,y):u(y,i);const c=(0,g.qh)(i).filter((([e,p])=>p!==t[e])).map((([e,o])=>({isPlayer:!0,statusProp:e,to:o,noSound:"player"===p.owner&&e===f&&o===l}))).concat((0,g.qh)(y).filter((([e,p])=>p!==n[e])).map((([e,o])=>({isPlayer:!1,statusProp:e,to:o,noSound:"opponent"===p.owner&&e===f&&o===l}))));return(0,O.of)({type:a.g$,payload:c}).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.qr)),(0,l.M)(p),(0,u.b)((([p,o])=>{const{n:t,index:n,position:i,owner:y}=p,s=o.multiplayer.gameNumber;return(0,h.z)((0,O.of)({type:a.xZ,payload:{type:a.ao,n:t,index:n,position:i,owner:y}}),s>0?(0,O.of)({type:a.H8,kind:b.d,data:{type:a.u3,payload:{type:a.ao,n:t,index:n,position:i,owner:(0,x._w)(y)}}}):w.E).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.u3)),(0,u.b)((e=>{const{payload:p}=e;return Z.f.enqueue(p),w.E})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.tI)),(0,u.b)((p=>{const o=Z.f.dequeueAsync();return(0,R.D)(o).pipe((0,U.U)((e=>({type:a.xZ,payload:e}))),(0,d.R)(e.ofType(a.Cv)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.xZ)),(0,l.M)(p),(0,u.b)((([o,t])=>{const{payload:n}=o;return t.game.locked.some((e=>!0===e))?((0,z.Z)(`${JSON.stringify(n)} executed during the lock ${JSON.stringify(t.game.locked)}. the game will try to fix that`,"warning"),p.pipe((0,U.U)((e=>e.game.locked)),(0,f.h)((e=>!e.some((e=>!0===e)))),(0,k.q)(1),(0,U.U)((()=>n)),(0,d.R)(e.ofType(a.Cv)))):(0,O.of)(n)})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.ao)),(0,l.M)(p),(0,u.b)((([p,o])=>{const{n:t,index:n,position:i,owner:y}=p,s=T.Z[t].special;return(0,M.Z)("deal",o.volume),(0,h.z)(o.game.isNewTurn?(0,O.of)({type:a.kH}):w.E,(0,O.of)({type:a.Uk,n:t,owner:y}),(0,O.of)({type:a.PX,index:n}),(0,O.of)({type:a.fj,index:n,position:i,owner:y}),(0,O.of)({type:a.Ut,on:!0}),(null==s?void 0:s.drawDiscardPlayagain)?(0,h.z)((0,O.of)({type:a.vd,on:!0}),(0,O.of)({type:a.NX}).pipe((0,E.g)(0)),(0,O.of)({type:a.Jn,index:n}).pipe((0,E.g)(N.RE+N.Oz)),(0,O.of)({type:a.Ut,on:!1})):(0,h.z)((0,O.of)({type:a.Jn,index:n}).pipe((0,E.g)(N.RE+N.Oz)),(null==s?void 0:s.playagain)?(0,h.z)((0,O.of)({type:a.NX}).pipe((0,E.g)(0)),(0,O.of)({type:a.Ut,on:!1})):(0,O.of)({type:a.jV}).pipe((0,E.g)(N.RE)))).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.fL)),(0,l.M)(p),(0,u.b)((([p,o])=>{const{index:t,position:n,owner:i}=p,y=o.multiplayer.gameNumber;return(0,h.z)((0,O.of)({type:a.xZ,payload:{type:a.xr,index:t,position:n,owner:i}}),y>0?(0,O.of)({type:a.H8,kind:b.d,data:{type:a.u3,payload:{type:a.xr,index:t,position:n,owner:(0,x._w)(i)}}}):w.E).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.xr)),(0,l.M)(p),(0,u.b)((([p,o])=>{const{index:t,position:n,owner:i}=p;return(0,M.Z)("deal",o.volume),(0,h.z)(o.game.isNewTurn?(0,O.of)({type:a.kH}):w.E,(0,O.of)({type:a.iE,index:t}),(0,O.of)({type:a.Jn,index:t}).pipe((0,E.g)(0)),(0,O.of)({type:a.fj,index:t,position:n,owner:i}),o.game.discardMode?(0,h.z)((0,O.of)({type:a.vd,on:!1}),(0,O.of)({type:a.NX}).pipe((0,E.g)(0))):(0,h.z)((0,O.of)({type:a.Ut,on:!0}),(0,O.of)({type:a.jV}).pipe((0,E.g)(N.RE)))).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.Jn)),(0,l.M)(p),(0,u.b)((([p,o])=>{const t=o.cards.list,n=t[p.index];if(null!==n&&!1===v.includes(n.position)){const o=v.find((e=>t.every((p=>(null==p?void 0:p.position)!==e))));return void 0===o?(0,h.z)((0,O.of)({type:a.kH}),(0,O.of)({type:a.Jn,index:p.index})).pipe((0,d.R)(e.ofType(a.OU))):(0,O.of)({type:a._d,index:p.index,toPosition:o}).pipe((0,d.R)(e.ofType(a.OU)))}return w.E})))),H.Z,q.Z,((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.qg)),(0,l.M)(p),(0,u.b)((([e,p])=>{const o=p.multiplayer.on&&"connected_to_id"===p.multiplayer.status,t=(p.multiplayer.on&&p.multiplayer.status,o?(new Date).getTime():null),n=Math.random()<.5,i=[],y=p.settings.cardsInHand;for(let e=0,p=2*y;e<p;e++){const p={position:e%y,n:(0,_.d)(),unusable:!1,discarded:!1,isFlipped:!1,zeroOpacity:!1,owner:e<y?"player":"opponent"};i.push(p)}return(0,h.z)((0,O.of)({type:a.OU}),(0,O.of)({type:a.pS,playersTurn:n,cardList:i,gameNumber:t}),o?(0,h.z)((0,O.of)({type:a.H8,kind:b.d,data:{type:a.OU}}),(0,O.of)({type:a.H8,kind:b.d,data:{type:a.pS,playersTurn:!n,cardList:(0,x.b1)(i),gameNumber:t}})):w.E)})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.pS)),(0,l.M)(p),(0,u.b)((([p,o])=>{o.multiplayer.on&&o.multiplayer.status,o.multiplayer.on&&o.multiplayer.status;const{playersTurn:t,cardList:n,gameNumber:i}=p,y=o.settings.cardsInHand,s={total:{player:y,opponent:y},list:n,nextPos:{player:y,opponent:y}};return(0,h.z)((0,O.of)({type:a.zn,payload:s}),(0,O.of)({type:a.s3,playersTurn:t}),(0,O.of)({type:a.F5,payload:(0,P.iT)(o.settings)}),null!==i?(0,O.of)({type:a.xD,n:i}):w.E,(0,O.of)({type:a.k4,owner:t?"player":"opponent"}),(0,O.of)({type:a.NX}).pipe((0,E.g)(0))).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.NX)),(0,l.M)(p),(0,u.b)((([p,o])=>{const t="connected_to_id"===o.multiplayer.status;let n;if(-1===o.multiplayer.gameNumber)n=(0,O.of)({type:a.kp,n:(0,_.d)()}).pipe((0,E.g)(0));else if(t){const e=(0,_.d)();n=(0,h.z)((0,O.of)({type:a.kp,n:e}).pipe((0,E.g)(0)),(0,O.of)({type:a.H8,kind:b.d,data:{type:a.M0,n:e}}))}else n=(0,O.of)({type:a.tM}).pipe((0,E.g)(0));return(0,h.z)((0,O.of)({type:a.Ut,on:!0,locknumber:1}),n).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.M0)),(0,u.b)((e=>{const{n:p}=e;return Z.I.enqueue(p),w.E})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.tM)),(0,u.b)((p=>{const o=Z.I.dequeueAsync();return(0,R.D)(o).pipe((0,u.b)((e=>(0,O.of)({type:a.kp,n:e}).pipe((0,E.g)(0)))),(0,d.R)(e.ofType(a.Cv)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.kp)),(0,l.M)(p),(0,u.b)((([p,o])=>{const{n:t}=p,n=o.game.playersTurn?"player":"opponent",i=o.multiplayer.gameNumber;return(0,M.Z)("deal",o.volume),(0,z.Z)(`${n} draws card ${t}`,"info"),(0,h.z)((0,O.of)({type:a.$Z,n:t}),(0,O.of)({type:a.Qo,lastOnly:!0}),(0,O.of)({type:a.B4,owner:n}).pipe((0,E.g)(N.Fi)),(0,O.of)({type:a.Ut,on:!1,locknumber:1}).pipe((0,E.g)(0)),"opponent"===n&&$.Hz&&-1===i?(0,O.of)({type:a.cx}).pipe((0,E.g)(N.RE+N.CF+($.G1?0:$.kQ))):w.E,"opponent"===n&&i>0?(0,O.of)({type:a.tI}).pipe((0,E.g)(N.RE+N.t7)):w.E,"player"===n?(0,O.of)({type:a.yh}).pipe((0,E.g)(0)):w.E).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.jV)),(0,l.M)(p),(0,u.b)((([p,o])=>(0,h.z)((0,O.of)({type:a.K5}),(0,O.of)({type:a.k4,owner:o.game.playersTurn?"opponent":"player"}),(0,O.of)({type:a.Ut,on:!1}),(0,O.of)({type:a.NX}).pipe((0,E.g)(0)),(0,O.of)({type:a.Z$,on:!0})).pipe((0,d.R)(e.ofType(a.OU))))))),j.Z,((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.kH)),(0,l.M)(p),(0,I.zg)((([p,o])=>{const t=[],n=[],i=[];return S.forEach((e=>{o.cards.list.forEach(((p,o)=>{null!==p&&p.position===e&&(t.push((0,O.of)({type:a.EK,index:o})),n.push((0,O.of)({type:a.OK,index:o}).pipe((0,E.g)(N.RE))),i.push((0,O.of)({type:a.M2,index:o}).pipe((0,E.g)(2*N.RE))))}))})),(0,J.T)((0,O.of)({type:a.Z$,on:!1}),(0,J.T)(...t,...n,...i)).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.Qo)),(0,l.M)(p),(0,u.b)((([p,o])=>{const t=[],n=[],i=(e,i)=>{if(null!==e){const y=p.lastOnly?o.game.playersTurn?"player":"opponent":e.owner;if("common"!==y){const{type:p,cost:s}=T.Z[e.n];o.status[y][m.ag[p]]<s?e.unusable||t.push(i):e.unusable&&n.push(i)}}};if(p.lastOnly){const e=o.cards.list,p=e.length-1;i(e[p],p)}else o.cards.list.forEach(i);return(0,O.of)({type:a.R9,unusables:t,usables:n}).pipe((0,d.R)(e.ofType(a.OU)))})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.Dt)),(0,l.M)(p),(0,u.b)((([p,o])=>{const{winTower:t,winResource:n}=(0,P.Ib)(o.settings),{player:i,opponent:y}=o.status,s=i.tower>=t||y.tower<=0||m.ag.some((e=>i[e]>=n)),r=y.tower>=t||i.tower<=0||m.ag.some((e=>y[e]>=n));return s&&!r?(0,O.of)({type:a.Wz,payload:{type:"win"}}).pipe((0,d.R)(e.ofType(a.OU))):!s&&r?(0,O.of)({type:a.Wz,payload:{type:"lose"}}).pipe((0,d.R)(e.ofType(a.OU))):s&&r?(0,O.of)({type:a.Wz,payload:{type:"tie"}}).pipe((0,d.R)(e.ofType(a.OU))):w.E})))),X.Z,((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.cx)),(0,l.M)(p),(0,u.b)((([p,o])=>{const t=(0,C.ai)(o);if(null===t)return(0,O.of)({type:a.Wz,payload:{type:"win",surrender:!0}}).pipe((0,d.R)(e.ofType(a.OU)));const{index:n,use:i}=t,y=o.cards.list[n];if(null!==y&&"common"!==y.owner){const{n:p,position:o,owner:t}=y;return i?(0,O.of)({type:a.qr,index:n,n:p,position:o,owner:t}).pipe((0,d.R)(e.ofType(a.OU))):(0,O.of)({type:a.fL,index:n,position:o,owner:t}).pipe((0,d.R)(e.ofType(a.OU)))}return w.E})))),((e,p)=>e.pipe((0,f.h)((0,c.isOfType)(a.yh)),(0,l.M)(p),(0,u.b)((([p,o])=>0===(0,D.Z)(o,"player").filter((e=>e.canuse||e.candiscard)).length?(0,O.of)({type:a.Wz,payload:{type:"lose",surrender:!0}}).pipe((0,d.R)(e.ofType(a.OU))):w.E)))),L.Z,W.Z,F.Z,K.Z,Q.Z,V.Z,A.Z,B.Z,G.Z,Y.Z,ee.Z,pe.Z)}}]);