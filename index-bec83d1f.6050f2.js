"use strict";(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[4096],{10611:function(e,t,n){n.d(t,{Z:function(){return oe}});var r=n(67294),a=n(6360),i=n(94184),o=n.n(i),l=n(94989),s=n(18255),c=n(91304),m=n(48023),d=n(6399),p=(0,r.memo)((({type:e,isProd:t,isOpponent:n})=>{const i=(0,a.C)((r=>r.status[n?"opponent":"player"][c.CR[e][t?1:0]]));return r.createElement(r.Fragment,null,r.createElement(d.Z,{n:i}),r.createElement(m.Z,{n:i}))})),u=n(40370),g=n(37879),b=n(7927),h=n(74983),f=n(97463),v=n(81317),y=n(90009),E=n(2301),w=n(74461),x=n(87346);const $=(e,t)=>{const n=e*t;return n>=12?n:12},k=(e,t)=>1.2*$(e,t),N=e=>`(${e}px - 1.25rem * 2 - (1.75rem + 0.25rem * 2 + 1rem) - (0.25rem * 2 + ${k(e,.036)}px + 0.25rem + 0.75rem) * 3) / 3`,C=(0,l.QM)({brick:{"background-image":`url(${u})`,"background-position":"center 15%"},gem:{"background-image":`url(${g})`,"background-position":"center 21%"},recruit:{"background-image":`url(${b})`},prodcontainer:{"min-height":"2em"},prod:{"font-size":({height:e})=>`${$(e,.05)}px`,"line-height":({height:e})=>`${k(e,.05)}px`,"margin-bottom":"-0.2em"},count:{"font-size":({height:e})=>`${$(e,.036)}px`,"line-height":({height:e})=>`${k(e,.036)}px`,height:({height:e})=>`${k(e,.036)}px`,width:"42.5%"},unit:{"font-size":({height:e,unitTextLength:t})=>{let n=$(e,.036);return t>v.X0&&(n=n/t*(v.X0+1)),`${n}px`},"line-height":({height:e})=>`${k(e,.036)}px`,height:({height:e})=>`${k(e,.036)}px`,width:({height:e,smallMode:t})=>t?`${k(e,.036)}px`:"57.5%","background-image":({type:e,smallMode:t})=>t?`url(${{brick:y,gem:E,recruit:w}[e]})`:"none",background:{repeat:"no-repeat",size:"cover",position:"center center"},opacity:({smallMode:e})=>e?.75:1,transform:({type:e,smallMode:t})=>{if(t){if("gem"===e)return"translateY(-12%)";if("recruit"===e)return"translateY(6%)"}return"none"}}});var O=(0,r.memo)((({type:e,isOpponent:t})=>{const n=(0,r.useContext)(h.O),i=(0,r.useContext)(s.$),l=i.height,c=l*(i.narrowMobile?.5:2/3),m=l<v.A1,d={brick:"red",gem:"blue",recruit:"green"}[e],u=n.i18n({brick:"bricks",gem:"gems",recruit:"recruits"}[e]),g=C({type:e,height:c,smallMode:m,unitTextLength:m?0:u.replace(/[ыщ]/g,"  ").replace(/ll/g,"l").replace(/in/g,"n").length});let b=n.i18n((t?"Opponent's":"Your")+" %s").replace("%s",n.i18n("%s (%ss production)").replace("%s",n.i18n({brick:"quarry",gem:"magic",recruit:"dungeon"}[e])).replace("%ss",n.i18n(e)).replace("%sp",n.i18n({brick:"bricks",gem:"gems",recruit:"recruits"}[e])));b=(0,f.m)(b);const y=(0,a.C)((e=>e.settings.winResource));let E=n.i18n((t?"Opponent's":"Your")+" %sp").replace("%sp",n.i18n({brick:"bricks",gem:"gems",recruit:"recruits"}[e])).replace("%ss",n.i18n(e));return E=n.i18n("%s1. Reach %s2 to win").replace("%s1",E).replace("%s2",y.toString(10)),E=(0,f.m)(E),r.createElement("div",{className:o()("mb-3 p-1 shadow-lg",`bg-${d}-300`)},r.createElement(x.Z,{title:b,placement:t?"left":"right"},r.createElement("div",{className:o()(g.prodcontainer,"bg-no-repeat bg-cover bg-center border border-l-darkborder border-t-darkborder border-r-lightborder border-b-lightborder relative"),style:{height:`calc(${N(c)})`}},r.createElement("div",{className:o()(g[e],"w-full h-full bg-cover pixelated")}),r.createElement("div",{className:o()(g.prod,"text-yellow-400 absolute bottom-1 left-1 text-shadow-md tracking-tighter","fatnumber","el-number")},r.createElement(p,Object.assign({isProd:!0},{type:e,isOpponent:t}))))),r.createElement(x.Z,{title:E,placement:t?"left":"right"},r.createElement("div",{className:"flow-root mt-1"},r.createElement("div",{className:o()(g.count,"float-left text-black flex-1 text-left relative tracking-tighter","fatnumber","el-number")},r.createElement(p,Object.assign({isProd:!1},{type:e,isOpponent:t}))),r.createElement("div",{className:o()(g.unit,"float-right text-black flex-1 text-right","robotocondensed","el-text")},m?"":u))))}));const Z=(0,l.QM)({main:{width:({height:e})=>`calc(${(e=>`${N(e)} / 0.7222222222222222 + 0.25rem * 2 + 1.25rem * 2`)(e)})`,"min-width":"7.8rem",float:({isOpponent:e})=>e?"right":"left"},username:{"transition-property":"color, border-color","transition-timing-function":"ease-in-out","transition-duration":"0.3s"}});var M=(0,r.memo)((({playerName:e,isOpponent:t=!1})=>{const n=(0,r.useContext)(h.O),i=(0,a.C)((e=>e.game.playersTurn)),l=(0,r.useContext)(s.$).height/3*2,c=Z({height:l,isOpponent:t});return r.createElement("div",{className:o()(c.main,"z-20 p-5 h-full relative")},r.createElement("div",{className:"bg-black bg-opacity-50 mb-4 p-1 shadow-lg"},r.createElement(x.Z,{title:n.i18n(t?"Opponent's Name":"Your Name"),placement:t?"left":"right"},r.createElement("div",{className:o()("border border-yellow-400 text-yellow-400 text-center h-7 leading-7 font-mono",{"border-opacity-25 text-opacity-25":i===t},c.username,"el-text","emoji")},e))),r.createElement(O,{type:"brick",isOpponent:t}),r.createElement(O,{type:"gem",isOpponent:t}),r.createElement(O,{type:"recruit",isOpponent:t}))})),P=n(24410),z=n(50970),L=n(27977),X=n(64583);const j=(0,l.QM)({mainbg:{background:{image:`url(${X})`,repeat:"no-repeat",size:"cover",position:"center 30%"}}});var R=(0,r.memo)((()=>{const e=(0,a.C)((e=>e.settings.playerName)),t=(0,a.C)((e=>e.settings.opponentName)),n=(0,a.C)((e=>e.settings.winTower)),i=(0,a.C)((e=>e.multiplayer.on)),l=(0,a.C)((e=>e.multiplayer.status)),c=i&&("connected_by_id"===l||"connected_to_id"===l),m=(0,a.C)((e=>e.multiplayer.tempPlayerName)),d=(0,a.C)((e=>e.multiplayer.tempOpponentName)),p=(0,r.useContext)(s.$),u=j();return r.createElement("div",{className:o()("z-0 flex-auto bg-green-100 relative",p.narrowMobile?"h-1/2":"h-2/3")},r.createElement("div",{className:o()(u.mainbg,"w-full h-full bg-cover pixelated")}),r.createElement("div",{className:"absolute top-0 left-0 w-full h-full"},r.createElement(M,{playerName:c?m:e}),r.createElement(P.Z,{goal:n}),r.createElement(z.Z,null),r.createElement(M,{playerName:c?d:t,isOpponent:!0}),r.createElement(P.Z,{isOpponent:!0,goal:n}),r.createElement(z.Z,{isOpponent:!0}),r.createElement(L.Z,null)))})),Y=n(63211),T=n(90583),_=n(87173),H=n(49006),I=n(23644),Q=n(43543);const K=({unusable:e,zeroOpacity:t})=>t?0:e?v.fv:1,S=(0,l.QM)({main:{width:({cardPos:e})=>null==e?void 0:e.width,height:({cardPos:e})=>null==e?void 0:e.height,top:({cardPos:e,total:t,position:n})=>null==e?void 0:e[t===e.total?"top":"topM1"][n+5],left:({cardPos:e,total:t,position:n})=>null==e?void 0:e[t===e.total?"left":"leftM1"][n+5],"font-size":({cardPos:e})=>e?.094*e.width:16,"will-change":"transform, left, top","transition-property":"opacity, transform, left, top","transition-timing-function":"ease-in-out","transition-duration":`${v.RE}ms`},cardname:{"font-size":({cardPos:e,cardNameLength:t})=>t>v.oK?(e?.094*e.width:16)*(v.oK+1)/t:"inherit",height:({cardPos:e})=>1.1*(e?.094*e.width:16),"line-height":({cardPos:e})=>1.1*(e?.094*e.width:16)+"px"},isflipped:{transform:"translateX(-100%) rotateY(-179.99deg)"},cardeffect:{"transform-style":"preserve-3d","transform-origin":"center right"},cardfront:{"background-image":`url(${_})`,"backface-visibility":"hidden",opacity:K,"will-change":"transform, left, top","transition-property":"opacity, transform, left, top","transition-timing-function":"ease-in-out","transition-duration":`${v.RE}ms`,"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${v.st}, ${v.st}, ${v.st}, ${v.LX}), rgba(0, 0, 0, 0), rgba(${v.st}, ${v.st}, ${v.st}, ${v.LX}))`}},unusableopacity:{opacity:v.fv},cardback:{opacity:K,"will-change":"transform, left, top","transition-property":"opacity, transform, left, top","transition-timing-function":"ease-in-out","transition-duration":`${v.RE}ms`,"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${v.st}, ${v.st}, ${v.st}, ${v.LX}), rgba(0, 0, 0, 0), rgba(${v.st}, ${v.st}, ${v.st}, ${v.LX}))`}},cardbackeffect:{transform:"translateX(0) rotateY(180deg)","backface-visibility":"hidden"},cardbackhard:{"&:before":{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",content:'""',background:`linear-gradient(to left, rgba(${v.st}, ${v.st}, ${v.st}, ${v.LX}), rgba(0, 0, 0, 0), rgba(${v.st}, ${v.st}, ${v.st}, ${v.LX}))`}},cardbackimage:{background:{image:`url(${H})`,size:"cover",position:"center",repeat:"no-repeat"}},imagewrapper:{height:"calc((100% / 63 * 47 - 0.5rem) / 22 * 13)"},discarded:{"font-size":"125%"},text:{height:({cardPos:e})=>`calc(100% - (${1.1*(e?.094*e.width:16)}px + 0.25rem + 0.25rem) - (0.5rem + 0.5rem) - (100% / 63 * 47 - 0.5rem) / 22 * 13)`},resall:{width:({cardPos:e})=>.2*(e?e.width:0),height:({cardPos:e})=>.2*(e?e.width:0),"line-height":({cardPos:e})=>.2*(e?e.width:0)+"px"},resbg:{"background-image":({type:e})=>void 0===e?"none":`url(${[y,E,w][e]})`,background:{repeat:"no-repeat",size:"cover",position:"center center"},opacity:v.Em}});var q=(0,r.memo)((({n:e,unusable:t=!1,discarded:i=!1,position:l,owner:s="common",index:c=-1,isFlipped:m=!1,zeroOpacity:d=!1})=>{const p=(0,r.useContext)(h.O),u=p.cards(e,"name"),g=u.length,b=(0,a.C)((e=>e.game.playersTurn)),f=(0,a.C)((e=>e.game.locked)).some((e=>!0===e)),v=(0,a.C)((e=>e.game.discardMode)),y=(0,r.useRef)(null),E=(0,a.C)((e=>e.multiplayer.gameNumber)),w=(0,a.C)((e=>e.cards.total)),$=(0,a.T)(),k=(0,r.useContext)(Q._),N="common"===s?w[b?"player":"opponent"]:w[s],C=-1===e||I.E5&&"opponent"===s?void 0:T.Z[e].type,O=S({cardPos:k,total:N,position:l,type:C,unusable:t,zeroOpacity:d,cardNameLength:g});if(void 0===C)return r.createElement("button",{ref:y,disabled:!0,"aria-hidden":"true",className:o()(O.main,O.cardbackhard,"transform absolute rounded shadow-lg",{"opacity-0 pointer-events-none":b&&"opponent"===s||!b&&"player"===s,[O.unusableopacity]:-1===e})},r.createElement("div",{className:o()(O.cardbackimage,"w-full h-full bg-cover pixelated")}));{const{cost:a,special:d}=T.Z[e],g=["red","blue","green"][C];let h=!0;const w=()=>{"common"!==s&&$({type:Y.qr,n:e,index:c,position:l,owner:s})},k=()=>{"common"!==s&&$({type:Y.fL,index:c,position:l,owner:s})},N=(()=>{if(!("common"===s||f||I.Hz&&-1===E&&"opponent"===s))if(v){if(I.rd||!(null==d?void 0:d.undiscardable))return h=!1,{onClick:k}}else if(!t)return h=!1,{onClick:w};return{}})(),Z="common"===s||f||!(!(null==d?void 0:d.undiscardable)||v&&I.rd)||I.Hz&&-1===E&&"opponent"===s?{}:(h=!1,{onContextMenu:e=>{e.preventDefault(),k()}});(b&&"opponent"===s||!b&&"player"===s)&&(h=!0);const M=p.i18n("This card costs %s").replace("%s",1===a?p.i18n(["1 brick","1 gem","1 recruit"][C]):p.i18n(["%s bricks","%s gems","%s recruits"][C]).replace("%s",a.toString(10)));return r.createElement("button",Object.assign({ref:y,className:o()(O.main,O.cardeffect,{[O.isflipped]:m},"transform absolute rounded",{"opacity-0 pointer-events-none":b&&"opponent"===s||!b&&"player"===s},{"shadow-lg":-1!==l},{"cursor-pointer hover:scale-105":l>=0}),accessKey:!h&&l>=0&&l<9?(l+1).toString(10):"",tabIndex:h?-1:l+1,disabled:h},h?{"aria-hidden":"true"}:[],N,Z,{onKeyDown:e=>{if("Delete"===e.key||"Backspace"===e.key){const e=y.current;if(e){const t=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!1,view:window,button:2,buttons:0,clientX:e.getBoundingClientRect().x,clientY:e.getBoundingClientRect().y});e.dispatchEvent(t)}}}}),r.createElement("div",{className:o()(O.cardfront,"absolute top-0 bottom-0 left-0 right-0 rounded",`bg-${g}-300`)},r.createElement("div",{className:o()(O.cardname,"m-1 shadow text-center font-semibold tracking-tight",`bg-${g}-200`,"el-text")},u),r.createElement("div",{className:o()(O.imagewrapper,"relative m-1 shadow bg-no-repeat bg-cover bg-center")},r.createElement("div",{style:{backgroundImage:`url(${n(63323)(`./${e}.webp`)})`},className:"w-full h-full bg-cover pixelated"}),i&&r.createElement("div",{className:o()(O.discarded,"absolute top-0 left-0 w-full h-full flex justify-center items-center text-red-500 font-bold uppercase text-shadow-stroke","el-text")},p.i18n("discarded"))),r.createElement("div",{className:o()(O.text,"m-2 flex flex-wrap items-center justify-center")},r.createElement("div",{className:o()("leading-tight break-words text-center","el-text")},p.cards(e,"desc"))),r.createElement("div",{className:o()(O.resall,"absolute bottom-1 right-1 text-center font-bold")},r.createElement("div",{className:o()(O.resbg,"absolute top-0 left-0 w-full h-full")}),r.createElement(x.Z,{title:M,placement:"top"},r.createElement("div",{className:o()("absolute top-0 left-0 w-full h-full","el-number")},a)))),r.createElement("div",{className:o()(O.cardback,O.cardbackeffect,"absolute top-0 bottom-0 left-0 right-0 rounded")},r.createElement("div",{className:o()(O.cardbackimage,"w-full h-full bg-cover pixelated")})))}})),B=n(30515);const D=(0,l.QM)({main:{background:{image:"linear-gradient(#326a4b, #000 2rem)"}}});var F=(0,r.memo)((()=>{const e=(0,a.C)((e=>e.cards.list)),t=(0,a.C)((e=>e.settings.cardsInHand)),n=(0,a.C)((e=>e.game.discardMode)),i=(0,r.useContext)(s.$),l=i.height,c=i.width,m=D();return r.createElement(Q.f,{cardsInHand:t,winHeight:l,winWidth:c},r.createElement("div",{className:o()(m.main,"flex-auto",i.narrowMobile?"h-1/2":"h-1/3")},r.createElement(q,{n:-1,position:-1,unusable:!0}),e.map(((e,t)=>null===e?null:r.createElement(q,Object.assign({key:t,index:t},e)))),r.createElement(B.Z,{shown:n})))})),A=n(87104),U=n(36194),W=n(21691),G=n(96499),J=n(73845),V=n(15586),ee=n(76777),te=n(56187),ne=n(23636),re=n(48093),ae=n(96559),ie=n(99871),oe=(0,r.memo)((()=>{const e=(0,a.C)((e=>e.screen.pref)),t=(0,a.C)((e=>e.screen.langPref)),n=(0,a.C)((e=>e.screen.sgPref)),i=(0,a.C)((e=>e.screen.end)),o=(0,a.C)((e=>e.screen.help)),l=(0,a.C)((e=>e.screen.landscape)),s=(0,a.C)((e=>e.screen.disconnectNotice)),c=(0,a.C)((e=>e.visual.visualvalues)),[m,d]=(0,r.useState)("");return(0,r.useEffect)((()=>{d((0,ae.qh)(c).filter((([e,t])=>re.yf[e]!==t)).map((([e,t])=>{const n=ie.p.find((t=>e===t.term));if(n){if("main"===n.type)return"hue"===n.term?`${n.css}(${t}deg)`:`${n.css}(${t})`;if(!0===t)return`url('#${n.css}')`}return null})).filter((e=>null!==e)).join(" "))}),[c]),r.createElement("div",Object.assign({className:"w-screen h-screen flex flex-col bg-black overflow-x-hidden select-none outline-none",tabIndex:-1},""!==m?{style:{filter:m}}:{}),r.createElement(R,null),r.createElement(F,null),(0,te.U)(i)&&r.createElement(U.Z,Object.assign({},i)),e&&r.createElement(W.Z,null),t&&r.createElement(G.Z,null),n&&r.createElement(J.Z,null),o&&r.createElement(V.Z,null),l&&r.createElement(ee.Z,null),s&&r.createElement(ne.Z,null),r.createElement(A.Z,null))}))}}]);