"use strict";(self.webpackChunkarcomage_hd=self.webpackChunkarcomage_hd||[]).push([[23],{21691:function(e,n,t){var a=t(67294),l=t(18172),r=t(20640),o=t.n(r),i=t(6360),c=t(3484),s=t(63211),m=t(74983),u=t(97463),p=t(97487),d=t(48093),b=t(96559),g=t(81317),y=t(91304),E=t(77456),h=t(39451),C=t(22502),v=t(87346),N=t(30273),f=t(44933),w=function(e,n){var t={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&n.indexOf(a)<0&&(t[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(a=Object.getOwnPropertySymbols(e);l<a.length;l++)n.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(t[a[l]]=e[a[l]])}return t};n.Z=(0,a.memo)((()=>{const e=(0,a.useContext)(m.O),n=(0,i.T)(),t=(0,a.useRef)(null),r=(0,a.useRef)(null),I=(0,i.C)((e=>e.multiplayer.on)),P=(0,i.C)((e=>e.multiplayer.yourId)),_=(0,i.C)((e=>e.multiplayer.status)),k=(0,i.C)((e=>e.multiplayer.tempSettings)),O=(0,i.C)((e=>e.multiplayer.tempPlayerName)),S=(0,i.C)((e=>e.multiplayer.tempOpponentName)),j=(0,i.C)((e=>e.multiplayer.gameNumber)),A=(0,i.C)((e=>e.ai.aiLevel)),x={playerName:(0,i.C)((e=>e.settings.playerName)),opponentName:(0,i.C)((e=>e.settings.opponentName)),tower:(0,i.C)((e=>e.settings.tower)),wall:(0,i.C)((e=>e.settings.wall)),bricks:(0,i.C)((e=>e.settings.bricks)),gems:(0,i.C)((e=>e.settings.gems)),recruits:(0,i.C)((e=>e.settings.recruits)),brickProd:(0,i.C)((e=>e.settings.brickProd)),gemProd:(0,i.C)((e=>e.settings.gemProd)),recruitProd:(0,i.C)((e=>e.settings.recruitProd)),winTower:(0,i.C)((e=>e.settings.winTower)),winResource:(0,i.C)((e=>e.settings.winResource)),cardsInHand:(0,i.C)((e=>e.settings.cardsInHand)),opponentId:(0,i.C)((e=>e.multiplayer.opponentId))},[$,R]=(0,a.useState)(x),[T,M]=(0,a.useState)(A),Y=e=>{const n=p.B.concat(d.he).findIndex((n=>(0,E.$)(e,n)));return n===p.B.length?-2:n},[Z,q]=(0,a.useState)(-10),[D,L]=(0,a.useState)(""),[B,H]=(0,a.useState)(!1),[U,F]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=$.tower+1,t=Math.max($.bricks+$.brickProd,$.gems+$.gemProd,$.recruits+$.recruitProd)+1;if($.winTower<e?R((n=>(0,l.ZP)(n,(n=>{n.winTower=e})))):$.winResource<t&&R((e=>(0,l.ZP)(e,(e=>{e.winResource=t})))),q(Y($)),U){const{playerName:e,opponentName:t,opponentId:a}=$,l=w($,["playerName","opponentName","opponentId"]);n({type:s.Ey,payload:l})}}),(0,E.Ug)($));const[G,J]=(0,a.useState)(-10);(0,a.useEffect)((()=>{J(Y(k))}),(0,E.Ug)(k));const z=(0,a.useRef)("");(0,a.useEffect)((()=>{if("connecting_to_id"!==z.current&&"connected_net"!==z.current||"connected_to_id"!==_){if(""!==z.current&&"connected_by_id"===_){const{playerName:e}=$;n({type:s.SA,name:e}),n({type:s.vm,name:e})}}else{const{playerName:e,opponentName:t,opponentId:a}=$,l=w($,["playerName","opponentName","opponentId"]);n({type:s.Ey,payload:l}),n({type:s.SA,name:e}),n({type:s.vm,name:e})}z.current=_}),[_,x.opponentId]),(0,a.useEffect)((()=>{R((e=>(0,l.ZP)(e,(e=>{e.opponentId=x.opponentId}))))}),[x.opponentId]);const Q=e=>{const{name:n,type:t,min:a,max:r}=e.target;let{value:o}=e.target;"number"===t&&(""===o&&(o="0"),parseInt(o,10)<parseInt(a,10)&&(o=a),parseInt(e.target.value,10)>parseInt(r,10)&&(o=r)),R((e=>(0,l.ZP)(e,(e=>{if((0,b.nr)(e,n))switch(t){case"text":e[n]=o.trim();break;case"number":e[n]=parseInt(o,10)}}))))},V=e=>{const{name:t,value:a}=e.target;t===y.$Y[0]&&(n({type:s.SA,name:a}),n({type:s.vm,name:a}))};return(0,a.useEffect)((()=>{switch(_){case"connecting_net":L(e.i18n("Connecting to the network ⌛"));break;case"connected_net":L(e.i18n("Connected to the network (but not to anyone) 🟡"));break;case"connecting_to_id":{const n=$.opponentId,t=n.length>10?`${n.substring(0,g._h)}...${n.substring(n.length-g._h)}`:n;L(e.i18n("Connecting to ID %s ⌛").replace("%s",t));break}case"connected_to_id":{const n=$.opponentId,t=`${n.substring(0,g._h)}...${n.substring(n.length-g._h)}`;L(e.i18n("Connected to ID %s ✅ You're the host 🏠").replace("%s",t));break}case"connected_by_id":{const n=x.opponentId,t=`${n.substring(0,g._h)}...${n.substring(n.length-g._h)}`;L(e.i18n("Connected by ID %s ✅ You're the guest 💼").replace("%s",t));break}case"failed":L(e.i18n("Connection failed ❌"));break;case"disconnected":L(e.i18n("Disconnected 🔌"))}}),[_,e]),(0,a.useEffect)((()=>{H(I&&"connected_by_id"===_),F(I&&"connected_to_id"===_)}),[_]),a.createElement(c.Z,{screenActionType:s.fy,onCancel:()=>{if(U){const{playerName:e,opponentName:t,opponentId:a}=x,l=w(x,["playerName","opponentName","opponentId"]);n({type:s.Ey,payload:l})}}},a.createElement("h3",{className:"preferences"},e.i18n("Preferences"),e.i18n(": "),a.createElement("span",{id:"opponentNotification"},j>0?e.i18n("You are playing against human"):e.i18n("You are playing against computer AI"))),a.createElement("div",{className:"two-column half"},a.createElement("label",null,a.createElement("span",null,e.i18n("Your Name"),e.i18n(": ")),a.createElement("input",{type:"text",name:y.$Y[0],id:y.$Y[0],className:"emoji",value:B||U?O:$.playerName,onChange:B||U?V:Q,onFocus:e=>{(0,C.Z)(e.target.value)&&e.target.select()}})),a.createElement("label",null,a.createElement("span",null,e.i18n("Opponent's Name"),e.i18n(": ")),a.createElement("input",{type:"text",name:y.$Y[1],id:y.$Y[1],className:"emoji",disabled:B||U,value:B||U?S:$.opponentName,onChange:B||U?V:Q,onFocus:e=>{(0,C.Z)(e.target.value)&&e.target.select()}}))),a.createElement("label",{className:"one-colume"},a.createElement("span",null,e.i18n("Choose a Tavern (Preset Preferences)"),e.i18n(": ")),a.createElement("select",{name:"tavern",id:"tavern",value:B?G:Z,disabled:B,onChange:e=>{(e=>{const n=-2===e?p.B.length:e;if(n>=0){const e=p.B.concat(d.he)[n];R((n=>Object.assign(Object.assign({},n),e)))}})(parseInt(e.target.value,10))}},a.createElement("option",{value:-2},e.i18n("Default")),p.b.map(((n,t)=>a.createElement("optgroup",{className:"font-light not-italic",label:`${e.i18n(["Castle in Enroth","Antagarich","Jadame"][n.c-6])} ${["🏰","🍺","🍺"][n.c-6]}`,key:t},(0,f.n)(p.B.map(((n,t)=>a.createElement("option",{value:t,key:t},e.taverns(t,"name")," - ",e.taverns(t,"location")))),p.b.map((e=>e.count)))[t]))),(-1===Z||B)&&a.createElement("option",{value:-1},e.i18n("Customized")))),a.createElement("h4",null,e.i18n("Starting Conditions"),e.i18n(": ")),a.createElement("div",{className:"four-column"},a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("tower"))),a.createElement("input",{type:"number",name:y.PO[0],id:y.PO[0],min:"1",disabled:B,value:B&&null!==k?k.tower:$.tower,onChange:Q})),a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("bricks"))),a.createElement("input",{type:"number",name:y.PO[2],id:y.PO[2],min:"0",disabled:B,value:B&&null!==k?k.bricks:$.bricks,onChange:Q})),a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("gems"))),a.createElement("input",{type:"number",name:y.PO[3],id:y.PO[3],min:"0",disabled:B,value:B&&null!==k?k.gems:$.gems,onChange:Q})),a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("recruits"))),a.createElement("input",{type:"number",name:y.PO[4],id:y.PO[4],min:"0",disabled:B,value:B&&null!==k?k.recruits:$.recruits,onChange:Q}))),a.createElement("div",{className:"four-column"},a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("wall"))),a.createElement("input",{type:"number",name:y.PO[1],id:y.PO[1],min:"0",disabled:B,value:B&&null!==k?k.wall:$.wall,onChange:Q})),a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("quarry"))),a.createElement("input",{type:"number",name:y.PO[5],id:y.PO[5],min:N.SR?1:0,disabled:B,value:B&&null!==k?k.brickProd:$.brickProd,onChange:Q})),a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("magic"))),a.createElement("input",{type:"number",name:y.PO[6],id:y.PO[6],min:N.SR?1:0,disabled:B,value:B&&null!==k?k.gemProd:$.gemProd,onChange:Q})),a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("dungeon"))),a.createElement("input",{type:"number",name:y.PO[7],id:y.PO[7],min:N.SR?1:0,disabled:B,value:B&&null!==k?k.recruitProd:$.recruitProd,onChange:Q}))),a.createElement("h4",null,e.i18n("Victory Conditions"),e.i18n(": ")),a.createElement("div",{className:"two-column"},a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("tower"))),a.createElement("input",{type:"number",name:y.qA[0],id:y.qA[0],min:$.tower+1,disabled:B,value:B&&null!==k?k.winTower:$.winTower,onChange:Q})),a.createElement("label",null,a.createElement("span",null,(0,u.m)(e.i18n("resource"))),a.createElement("input",{type:"number",name:y.qA[1],id:y.qA[1],min:Math.max($.bricks+$.brickProd,$.gems+$.gemProd,$.recruits+$.recruitProd)+1,disabled:B,value:B&&null!==k?k.winResource:$.winResource,onChange:Q}))),a.createElement("h4",null,e.i18n("Other Preferences"),e.i18n(": ")),a.createElement("div",{className:"two-column"},a.createElement("label",null,a.createElement("span",null,e.i18n("Cards in Hand")),a.createElement("input",{type:"number",name:y.qA[2],id:y.qA[2],min:"0",max:N.Zy,disabled:B,value:B&&null!==k?k.cardsInHand:$.cardsInHand,onChange:Q})),a.createElement("label",null,a.createElement("span",{className:"onethird"},e.i18n("AI Level")),a.createElement("select",{name:y.qA[3],id:y.qA[3],className:"twothird",value:T,disabled:j>0,onChange:e=>{M(parseInt(e.target.value,10))}},a.createElement("option",{className:"emoji",value:0},e.i18n("Genius")," 💡"),a.createElement("option",{className:"emoji",value:1},e.i18n("Smart")," 📚"),a.createElement("option",{className:"emoji",value:2},e.i18n("Mediocre")," 😐"),a.createElement("option",{className:"emoji",value:3},e.i18n("Stupid")," 👹"),a.createElement("option",{className:"emoji",value:4},e.i18n("Idiotic")," 🤡")))),a.createElement("h4",{className:"multiplayer"},a.createElement("label",null,a.createElement("input",{type:"checkbox",name:"isMultiplayer",id:"isMultiplayer",checked:I,onChange:e=>{n({type:s.LM,on:e.target.checked})}}),a.createElement("span",null,e.i18n("Multiplayer"),a.createElement(v.Z,{title:e.i18n("Multiplayer Mode is experimental and works only for users behind non-symmetric NAT"),placement:"top"},a.createElement("span",{className:"emoji"},"🧪")),e.i18n(": "),(I?e.i18n("on"):e.i18n("off")).toUpperCase())),a.createElement("span",{id:"multiplayerNotification",className:"emoji"},D)),a.createElement("div",{className:"multiplayer"},a.createElement("label",null,a.createElement("span",null,e.i18n("Your ID"),e.i18n(": ")),a.createElement("input",{type:"text",name:"yourId",id:"yourId",value:P,readOnly:!0,onClick:e=>{const n=e.target;""!==n.value&&(n.select(),o()(n.value),null!==t.current&&(t.current.classList.add("copied-shown"),null!==r.current&&clearTimeout(r.current),r.current=setTimeout((()=>{null!==t.current&&t.current.classList.remove("copied-shown")}),g.J8)))}}),a.createElement("span",{ref:t,className:"copied emoji"},e.i18n("Copied 📋✅")))),a.createElement("div",{className:"multiplayer"},a.createElement("label",null,a.createElement("span",null,e.i18n("Enter your opponent's ID"),e.i18n(": ")),a.createElement("input",{disabled:!I||"connecting_net"===_||"connecting_to_id"===_||"connected_to_id"===_||"connected_by_id"===_,type:"text",name:"opponentId",id:"opponentId",value:$.opponentId,onChange:Q})),a.createElement("button",{disabled:!I||"connecting_net"===_||"connecting_to_id"===_||"connected_to_id"===_||"connected_by_id"===_||""===$.opponentId,className:"highlight",onClick:e=>{n({type:s.$u,id:$.opponentId})}},e.i18n("Connect"))),a.createElement("div",{className:"button-wrapper"},a.createElement("button",{disabled:B,onClick:e=>{R((({opponentId:e})=>Object.assign(Object.assign({playerName:(0,h.UP)(d.yk),opponentName:(0,h.UP)(d.eA)},d.he),{isMultiplayer:I,yourId:P,opponentId:e}))),j<=0&&M(d.mM)}},e.i18n("Reset")),a.createElement("button",{disabled:B,className:"warning",onClick:()=>{n({type:s.fy,show:!1}),n({type:s.Cm,aiLevel:T});const{opponentId:e}=$,t=w($,["opponentId"]);n({type:s.cQ,payload:t})}},e.i18n("Apply & New Game"))))}))}}]);